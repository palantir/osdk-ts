"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[824],{4824:(e,t,i)=>{let a;i.d(t,{x:()=>ir});let r={centimeter:"CENTIMETERS",centimeters:"CENTIMETERS",cm:"CENTIMETERS",meter:"METERS",meters:"METERS",m:"METERS",kilometer:"KILOMETERS",kilometers:"KILOMETERS",km:"KILOMETERS",inch:"INCHES",inches:"INCHES",foot:"FEET",feet:"FEET",yard:"YARDS",yards:"YARDS",mile:"MILES",miles:"MILES",nautical_mile:"NAUTICAL_MILES",nauticalMile:"NAUTICAL_MILES","nautical miles":"NAUTICAL_MILES"},n={sec:"SECONDS",seconds:"SECONDS",min:"MINUTES",minute:"MINUTES",minutes:"MINUTES",hr:"HOURS",hrs:"HOURS",hour:"HOURS",hours:"HOURS",day:"DAYS",days:"DAYS",wk:"WEEKS",week:"WEEKS",weeks:"WEEKS",mos:"MONTHS",month:"MONTHS",months:"MONTHS",yr:"YEARS",year:"YEARS",years:"YEARS"},o={...n,quarter:"QUARTERS",quarters:"QUARTERS"},s={ms:"MILLISECONDS",milliseconds:"MILLISECONDS",...n};class l extends Error{constructor(e,t,i,a,r,n){super(e),this.message=e,this.errorName=t,this.errorCode=i,this.statusCode=a,this.errorInstanceId=r,this.parameters=n}}class c extends l{constructor(e,t,i){super(e,t),this.originalError=i}}class u extends Error{constructor(e){super("Validation Error"),this.validation=e}}let p={name:"__EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference"},d={name:"__EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid"},y={name:"__EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks"};var f=i(1571),h=i(1902),m=i(662);async function b(e,t){return(0,m.t)(e,"/bulk-links","PUT",t)}async function g(e,t,i){return(0,m.t)(e,"/ontology/ontology/bulkLoadEntities","POST",i)}async function v(e,t){return(0,m.t)(e,"/ontology/linkTypesForObjectTypes","POST",t)}async function w(e,t){return(0,m.t)(e,"/ontology/ontology/ontologies/load/all","POST",t)}var T=i(1599);function j(e,t){return{type:e,[e]:t}}function _(e,t){let{baseUrl:i,fetch:a,tokenProvider:r}=e;return{baseUrl:i,servicePath:t,fetchFn:a,tokenProvider:r}}function k(e){return e.results}function N(e,t){let{pageToken:i}=t;return i?{...e,pageToken:i}:void 0}async function*O(e,t,i,a){let r=a;for(;r;){let a=await e(r);for(let e of t(a))yield e;r=i(r,a)}}var S=i(960),E=i(7470),A=i(5203);function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;function i(t,i){return e.set(t,i),i}return{get:function(a){let r=e.get(a);return void 0===r&&void 0!==t?i(a,t(a)):r},set:i,remove:function(t){return e.delete(t)}}}function P(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,a=i("weak"===e?new WeakMap:new Map),r=i("weak"===e?new WeakMap:new Map),n={getOrUndefined:function(e){return a.get(e)},get:async function(e){var i,o;return null!==(o=null!==(i=a.get(e))&&void 0!==i?i:r.get(e))&&void 0!==o?o:n.set(e,t(e))},set:async function(e,t){try{let i=await r.set(e,t);return a.set(e,i),r.remove(e),i}catch(t){throw r.remove(e),t}}};return n}async function $(e,t){return null!=a||(a=await w(e,{})),a.ontologies[t]||(0,T.A)(!1),a.ontologies[t].currentOntologyVersion}let R=e=>P("strong",e).get;var I=new WeakMap,C=new WeakMap,D=new WeakMap,L=new WeakMap,x=new WeakMap,K=new WeakMap;class W{constructor(e){var t;(0,E._)(this,I,{writable:!0,value:void 0}),(0,E._)(this,C,{writable:!0,value:void 0}),(0,E._)(this,D,{writable:!0,value:void 0}),(0,E._)(this,L,{writable:!0,value:void 0}),(0,E._)(this,x,{writable:!0,value:void 0}),(0,E._)(this,K,{writable:!0,value:void 0}),this.forObjectByRid=R(async e=>Promise.resolve({getPropertyMapping:(0,S._)(this,L).bind(this,e),getLinkMapping:(0,S._)(this,x).bind(this,e),getRid:()=>e,getApiName:async()=>(await (0,S._)(this,K).call(this,e)).apiName})),this.forObjectByApiName=R(async e=>{let t=await (0,S._)(this,I).ontologyProvider.getObjectDefinition(e);return this.forObjectByRid(t.rid)}),(0,A._)(this,L,R(async e=>(function(e){1!==e.primaryKeys.length&&(0,T.A)(!1);let t=e.primaryKeys[0],i=Object.values(e.propertyTypes).find(e=>e.rid===t);if(!i)throw Error("Could not find PK property by rid: ".concat(t));let a=Object.fromEntries(Object.values(e.propertyTypes).map(e=>[e.id,e.apiName])),r=Object.fromEntries(Object.values(e.propertyTypes).map(e=>[e.apiName,e.id]));return{apiName:e.apiName,id:e.id,propertyIdToApiNameMapping:a,propertyApiNameToIdMapping:r,pk:{rid:t,apiName:i.apiName,type:i.type}}})(await (0,S._)(this,K).call(this,e)))),(0,A._)(this,x,R(async e=>{let t=await v((0,S._)(this,C),{includeObjectTypesWithoutSearchableDatasources:!0,loadRedacted:!1,objectTypeBranches:{},objectTypeVersions:{[e]:await this.ontologyVersion("")}});t.linkTypes[e]||(0,T.A)(!1);let i={};for(let a of t.linkTypes[e]){let t=(e,t,r)=>{let{apiName:n}=e;n&&(i[n]={apiName:n,directedLinkTypeRid:{linkTypeRid:a.rid,linkSide:t},otherObjectType:r})};if("oneToMany"===a.definition.type){let{oneToMany:{objectTypeRidManySide:i,manyToOneLinkMetadata:r,objectTypeRidOneSide:n,oneToManyLinkMetadata:o}}=a.definition;i===e&&t(r,"TARGET",n),n===e&&t(o,"SOURCE",i)}else if("manyToMany"===a.definition.type){let{manyToMany:{objectTypeRidA:i,objectTypeAToBLinkMetadata:r,objectTypeRidB:n,objectTypeBToALinkMetadata:o}}=a.definition;i===e&&t(r,"SOURCE",n),n===e&&t(o,"TARGET",i)}}return i})),(0,A._)(this,K,R(async e=>{var t,i;null===(t=(0,S._)(this,D))||void 0===t||t.debug("getConjureObjectType(".concat(e,")"));let a={datasourceTypes:[],objectTypes:[{identifier:{type:"objectTypeRid",objectTypeRid:e},versionReference:{type:"ontologyVersion",ontologyVersion:await this.ontologyVersion("")}}],linkTypes:[],sharedPropertyTypes:[],interfaceTypes:[],typeGroups:[],loadRedacted:!1,includeObjectTypeCount:void 0,includeObjectTypesWithoutSearchableDatasources:!0,includeEntityMetadata:void 0,actionTypes:[],includeTypeGroupEntitiesCount:void 0,entityMetadata:void 0},r=await g((0,S._)(this,C),void 0,a);return(null===(i=r.objectTypes[0])||void 0===i?void 0:i.objectType)||(0,T.A)(!1),r.objectTypes[0].objectType})),this.ontologyVersion=R(async()=>$((0,S._)(this,C),await (0,S._)(this,I).ontologyRid)),(0,A._)(this,I,e),(0,A._)(this,C,_(e,"ontology-metadata/api")),(0,S._)(this,I).ontologyProvider.getObjectDefinition,(0,A._)(this,D,null===(t=(0,S._)(this,I).logger)||void 0===t?void 0:t.child({mcc:!0}))}}let U=P("weak",e=>Promise.resolve(new W(e))).get;function B(e){if("type"in e&&"objectLocatorV2"!==e.type)throw Error("We do not support looking up object by rid");let t=Object.entries(e.objectLocatorV2.objectPrimaryKey);if(1!==t.length)throw Error("Unable to support this request due to multiple pks");return{objectTypeRid:e.objectLocatorV2.objectTypeRid,pkValue:t[0][1][t[0][1].type]}}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fetch,t=arguments.length>1?arguments[1]:void 0;return async function(i,a){return a?e(i,{...a,headers:await t(new Headers(a.headers))}):e(i,{headers:await t(new Headers)})}}var V=i(6316);let q=(e,t)=>({...e,fetch:F(e.fetch,i=>(i.set("X-OSDK-Request-Context",JSON.stringify(e.requestContext)),t.osdkMetadata&&i.set("Fetch-User-Agent",t.osdkMetadata.extraUserAgent),i))}),z=(e,t)=>({...e,requestContext:{...e.requestContext,...t(e.requestContext)}});function G(e){return"object"==typeof e&&"name"in e&&"data"in e&&e.data instanceof Blob}function Y(e){return"object"==typeof e&&e instanceof Blob&&"name"in e}function H(e){let t=e.lastIndexOf(".");return -1===t?[void 0,e]:[e.slice(0,t),e.slice(t+1)]}function J(e,t){if("$and"in e)return{type:"and",value:e.$and.map(e=>J(e,t))};if("$or"in e)return{type:"or",value:e.$or.map(e=>J(e,t))};if("$not"in e)return{type:"not",value:J(e.$not,t)};let i=Object.entries(e);return 1===i.length?Z(i[0],t):{type:"and",value:i.map(e=>Z(e,t))}}function Q(e,t,i,a){return{type:"$within"===t?"withinBoundingBox":"intersectsBoundingBox",...null!=i&&{propertyIdentifier:i},field:a,value:{topLeft:{type:"Point",coordinates:[e[0],e[3]]},bottomRight:{type:"Point",coordinates:[e[2],e[1]]}}}}function X(e,t,i,a){return{type:t,...null!=i&&{propertyIdentifier:i},field:a,value:{type:"Polygon",coordinates:e}}}function Z(e,t,i){let[a,n]=e;null!=n||(0,T.A)(!1);let o=null!=i?{type:"structField",...i,propertyApiName:ee(i.propertyApiName,t)}:void 0,s=null==i?ee(a,t):void 0;if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return{type:"eq",...null!=o&&{propertyIdentifier:o},field:s,value:n};let l=Object.keys(n),c=l.some(e=>e.startsWith("$"));if(c&&1!==l.length&&(0,T.A)(!1),!c){1!==Object.entries(n).length&&(0,T.A)(!1);let e=l[0];return Z(Object.entries(n)[0],t,{propertyApiName:a,structFieldApiName:e})}let u=l[0];if(null!=n[u]||(0,T.A)(!1),"$ne"===u)return{type:"not",value:{type:"eq",...null!=o&&{propertyIdentifier:o},field:s,value:n[u]}};if("$within"===u){let e=n[u];return Array.isArray(e)?Q(e,u,o,s):"$bbox"in e&&null!=e.$bbox?Q(e.$bbox,u,o,s):"$distance"in e&&"$of"in e&&null!=e.$distance&&null!=e.$of?{type:"withinDistanceOf",...null!=o&&{propertyIdentifier:o},field:s,value:{center:Array.isArray(e.$of)?{type:"Point",coordinates:e.$of}:e.$of,distance:{value:e.$distance[0],unit:r[e.$distance[1]]}}}:X("$polygon"in e?e.$polygon:e.coordinates,"withinPolygon",o,a)}if("$intersects"===u){let e=n[u];return Array.isArray(e)?Q(e,u,o,s):"$bbox"in e&&null!=e.$bbox?Q(e.$bbox,u,o,s):X("$polygon"in e?e.$polygon:e.coordinates,"intersectsPolygon",o,s)}if("$containsAllTerms"===u||"$containsAnyTerm"===u){var p;return{type:u.substring(1),...null!=o&&{propertyIdentifier:o},field:s,value:"string"==typeof n[u]?n[u]:n[u].term,fuzzy:"string"!=typeof n[u]&&null!==(p=n[u].fuzzySearch)&&void 0!==p&&p}}return{type:u.substring(1),...null!=o&&{propertyIdentifier:o},field:s,value:n[u]}}function ee(e,t){if("interface"===t.type){let[i]=H(t.apiName),[a,r]=H(e);return null==a&&null!=i?"".concat(i,".").concat(r):e}return e}function et(e){return e.metrics.reduce((e,t)=>{let i=t.name.split(".");if("count"===i[0])return e;2!==i.length&&(0,T.A)(!1);let a=i[0],r=i[1];return a in e||(e[a]={}),e[a][r]=t.value,e},{})}let ei=e=>"asc"===e?"ASC":"desc"===e?"DESC":void 0;function ea(e){return"interface"===e.type?{type:"interfaceBase",interfaceType:e.apiName}:{type:"base",objectType:e.apiName}}async function er(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ea(t),a=arguments.length>3?arguments[3]:void 0;ea(t);let r={aggregation:Object.entries(a.$select).flatMap(e=>{let[t,i]=e;if("$count"===t)return{type:"count",name:"count",direction:ei(i)};let a=t.lastIndexOf(":"),r=t.slice(0,a),n=t.slice(a+1);return[{type:n,name:"".concat(r,".").concat(n),direction:ei(i),field:r}]}),groupBy:[],where:void 0};if(a.$groupBy){var n;r.groupBy=(n=a.$groupBy)?Object.entries(n).flatMap(e=>{let[t,i]=e;if("exact"===i)return[{type:i,field:t}];if("$exactWithLimit"in i)return[{type:"exact",field:t,maxGroupCount:i.$exactWithLimit}];if("$exact"in i){var a,r,n;return[{type:"exact",field:t,maxGroupCount:null!==(r=null===(a=i.$exact)||void 0===a?void 0:a.$limit)&&void 0!==r?r:void 0,defaultValue:null!==(n=i.$exact.$defaultValue)&&void 0!==n?n:void 0}]}return"$fixedWidth"in i?[{type:"fixedWidth",field:t,fixedWidth:i.$fixedWidth}]:"$ranges"in i?[{type:"ranges",field:t,ranges:i.$ranges.map(e=>({startValue:e[0],endValue:e[1]}))}]:"$duration"in i?[{type:"duration",field:t,value:i.$duration[0],unit:o[i.$duration[1]]}]:[]}):[]}let s=await f.GB.aggregate(q(e,t),await e.ontologyRid,{objectSet:i,groupBy:r.groupBy,aggregation:r.aggregation});return a.$groupBy?s.data.map(e=>({$group:e.group,...en(e),...et(e)})):(1!==s.data.length&&(0,T.A)(!1),{...en(s.data[0]),...et(s.data[0])})}function en(e){for(let t of e.metrics)if("count"===t.name)return{$count:t.value}}async function eo(e,t,i,a){var r,n;if(i.$__UNSTABLE_useOldInterfaceApis){let n=await f.Y7.search(q(e,t),await e.ontologyRid,t.apiName,eu(i,{augmentedProperties:{},augmentedSharedPropertyTypes:{},otherInterfaceTypes:[],selectedObjectTypes:[],selectedSharedPropertyTypes:null!==(r=i.$select)&&void 0!==r?r:[],where:function e(t,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if("base"===t.type||"interfaceBase"===t.type){if("base"===t.type&&t.objectType!==i)throw Error("Expected objectSet.objectType to be ".concat(i,", but got ").concat(t.objectType));if("interfaceBase"===t.type&&t.interfaceType!==i)throw Error("Expected objectSet.objectType to be ".concat(i,", but got ").concat(t.interfaceType));return a}if("filter"===t.type)return e(t.objectSet,i,null==a?t.where:{type:"and",value:[a,t.where]});throw Error("Unsupported objectSet type: ".concat(t.type))}(a,t.apiName)}),{preview:!0});return n.data=await e.objectFactory(e,n.data,t.apiName,!i.$includeRid),n}let o=await f.GB.loadMultipleObjectTypes(q(e,t),await e.ontologyRid,eu(i,{objectSet:a,select:null!==(n=null==i?void 0:i.$select)&&void 0!==n?n:[],excludeRid:!(null==i?void 0:i.$includeRid)}),{preview:!0});return Promise.resolve({data:await e.objectFactory2(e,o.data,t.apiName,!i.$includeRid,i.$select,!1,o.interfaceToObjectTypeMappings),nextPageToken:o.nextPageToken,totalCount:o.totalCount})}async function es(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return"interface"===t.type?await eo(e,t,a,i):await ep(e,t,a,i)}async function el(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{return{value:await es(e,t,i,a)}}catch(e){return{error:e}}}async function ec(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ea(t);return es(e,t,a,i)}function eu(e,t){(null==e?void 0:e.$nextPageToken)&&(t.pageToken=e.$nextPageToken),(null==e?void 0:e.$pageSize)!=null&&(t.pageSize=e.$pageSize);let i=null==e?void 0:e.$orderBy;return i&&(t.orderBy="relevance"===i?{orderType:"relevance",fields:[]}:{fields:Object.entries(i).map(e=>{let[t,i]=e;return{field:t,direction:i}})}),t}async function ep(e,t,i,a){var r;let n=await f.GB.load(q(e,t),await e.ontologyRid,eu(i,{objectSet:a,select:null!==(r=null==i?void 0:i.$select)&&void 0!==r?r:[],excludeRid:!(null==i?void 0:i.$includeRid)}));return Promise.resolve({data:await e.objectFactory(e,n.data,void 0,void 0,i.$select),nextPageToken:n.nextPageToken,totalCount:n.totalCount})}async function ed(e,t,i,a){let r=await ec(e,t,{...i,$pageSize:1},a);if(1!==r.data.length||null!=r.nextPageToken)throw new l("Expected a single result but got ".concat(r.data.length," instead").concat(null!=r.nextPageToken?" with nextPageToken set":""));return r.data[0]}async function ey(e,t,i,a){try{return{value:await ed(e,t,i,a)}}catch(e){return{error:e}}}let ef=new Set(["base","filter","intersect","reference","searchAround","static","subtract","union"]);function eh(e){return null!=e&&"object"==typeof e&&ef.has(e.type)}var em=i(647),eb=i(9463),eg=i(7045),ev=i(6677);function ew(){}function eT(e){let{onChange:t=ew,onError:i=ew,onOutOfDate:a=ew,onSuccessfulSubscription:r=ew}=e;return{onChange:t,onError:i,onOutOfDate:a,onSuccessfulSubscription:r}}function ej(e){return null!=e.isReady}function e_(e){return"done"===e.status||"error"===e.status}var ek=new WeakMap,eN=new WeakMap,eO=new WeakMap,eS=new WeakMap,eE=new WeakMap,eA=new WeakMap,eM=new WeakMap,eP=new WeakMap,e$=new WeakSet,eR=new WeakSet,eI=new WeakSet,eC=new WeakSet,eD=new WeakMap,eL=new WeakMap,ex=new WeakMap,eK=new WeakSet,eW=new WeakMap,eU=new WeakMap,eB=new WeakSet,eF=new WeakMap,eV=new WeakMap,eq=new WeakMap;class ez{static getInstance(e){let t=(0,eg._)(ez,ez,eG).get(e.clientCacheKey);return null==t&&(t=new ez(e),(0,eg._)(ez,ez,eG).set(e.clientCacheKey,t)),t}async subscribe(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r="object"===e.type?await (0,S._)(this,eO).ontologyProvider.getObjectDefinition(e.apiName):await (0,S._)(this,eO).ontologyProvider.getInterfaceDefinition(e.apiName),n=[],o=[];0===a.length&&(a=Object.keys(r.properties)),n=a.filter(e=>"geotimeSeriesReference"!==r.properties[e].type),o=a.filter(e=>"geotimeSeriesReference"===r.properties[e].type);let s={listener:eT(i),objectSet:t,primaryKeyPropertyName:"interface"===r.type?void 0:r.primaryKeyApiName,requestedProperties:n,requestedReferenceProperties:o,status:"preparing",subscriptionId:"TMP-".concat(e1(),"}"),interfaceApiName:"object"===r.type?void 0:r.apiName};return(0,S._)(this,eA).set(s.subscriptionId,s),(0,em._)(this,e$,eY).call(this,s),()=>{(0,em._)(this,eI,eJ).call(this,s)}}constructor(e,{minimumReconnectDelayMs:t=5e3}={}){var i;(0,eb._)(this,e$),(0,eb._)(this,eR),(0,eb._)(this,eI),(0,eb._)(this,eC),(0,eb._)(this,eK),(0,eb._)(this,eB),(0,E._)(this,ek,{writable:!0,value:void 0}),(0,E._)(this,eN,{writable:!0,value:void 0}),(0,E._)(this,eO,{writable:!0,value:void 0}),(0,E._)(this,eS,{writable:!0,value:void 0}),(0,E._)(this,eE,{writable:!0,value:void 0}),(0,E._)(this,eA,{writable:!0,value:void 0}),(0,E._)(this,eM,{writable:!0,value:void 0}),(0,E._)(this,eP,{writable:!0,value:void 0}),(0,E._)(this,eD,{writable:!0,value:void 0}),(0,E._)(this,eL,{writable:!0,value:void 0}),(0,E._)(this,ex,{writable:!0,value:void 0}),(0,E._)(this,eW,{writable:!0,value:void 0}),(0,E._)(this,eU,{writable:!0,value:void 0}),(0,E._)(this,eF,{writable:!0,value:void 0}),(0,E._)(this,eV,{writable:!0,value:void 0}),(0,E._)(this,eq,{writable:!0,value:void 0}),(0,A._)(this,eN,0),(0,A._)(this,eE,new Map),(0,A._)(this,eA,new Map),(0,A._)(this,eM,new Set),(0,A._)(this,eD,()=>{(0,em._)(this,eR,eH).call(this)}),(0,A._)(this,eL,async e=>{let t=JSON.parse(e.data.toString());switch(t.type){case"objectSetChanged":return void(0,S._)(this,ex).call(this,t);case"refreshObjectSet":return void(0,S._)(this,eW).call(this,t);case"subscribeResponses":return void(0,S._)(this,eU).call(this,t);case"subscriptionClosed":return void(0,em._)(this,eB,eZ).call(this,t);default:(0,T.A)(!1)}}),(0,A._)(this,ex,async e=>{var t,i,a,r,n,o;let s=(0,S._)(this,eA).get(e.id);if(null==s)return;let l=e.updates.filter(e=>"object"===e.type),c=e.updates.filter(e=>"reference"===e.type);for(let e of(await Promise.all(c.map(async e=>{var t;let i=null!==(t=(await (0,S._)(this,eO).objectFactory2((0,S._)(this,eO),[{__apiName:e.objectType,__primaryKey:null!=s.primaryKeyPropertyName?e.primaryKey[s.primaryKeyPropertyName]:void 0,...e.primaryKey,[e.property]:e.value}],s.interfaceApiName,!1,void 0,!1,await (0,em._)(this,eK,eX).call(this,e.objectType,s.interfaceApiName)))[0])&&void 0!==t?t:void 0;return null!=i?{object:i,state:"ADDED_OR_UPDATED"}:void 0}))))if(null!=e)try{null===(t=(i=s.listener).onChange)||void 0===t||t.call(i,e)}catch(e){null===(a=(0,S._)(this,eS))||void 0===a||a.error(e,"Error in onChange callback"),(0,S._)(this,eq).call(this,s,!1,e)}for(let e of(await Promise.all(l.map(async e=>{var t;for(let t of Object.keys(e.object).filter(e=>s.requestedReferenceProperties.includes(e)))delete e.object[t];let i=null!==(t=(await (0,S._)(this,eO).objectFactory2((0,S._)(this,eO),[e.object],s.interfaceApiName,!1,void 0,!1,await (0,em._)(this,eK,eX).call(this,e.object.__apiName,s.interfaceApiName)))[0])&&void 0!==t?t:void 0;return null!=i?{object:i,state:e.state}:void 0}))))if(null!=e)try{null===(r=(n=s.listener).onChange)||void 0===r||r.call(n,e)}catch(e){null===(o=(0,S._)(this,eS))||void 0===o||o.error(e,"Error in onChange callback"),(0,S._)(this,eq).call(this,s,!1,e)}}),(0,A._)(this,eW,e=>{let t=(0,S._)(this,eA).get(e.id);t||(0,T.A)(!1);try{t.listener.onOutOfDate()}catch(e){var i;null===(i=(0,S._)(this,eS))||void 0===i||i.error(e,"Error in onOutOfDate callback"),(0,S._)(this,eq).call(this,t,!1,e)}}),(0,A._)(this,eU,e=>{let{id:t,responses:i}=e,a=(0,S._)(this,eE).get(t);a||(0,T.A)(!1),(0,S._)(this,eE).delete(t);for(let e=0;e<i.length;e++){let t=a[e],n=i[e];switch(n.type){case"error":(0,S._)(this,eq).call(this,t,!0,n.errors),(0,em._)(this,eI,eJ).call(this,t,"error");break;case"qos":(0,S._)(this,eV).call(this);break;case"success":var r;let o="expired"===t.status||"reconnecting"===t.status;t.status="subscribed",t.subscriptionId!==n.id&&((0,S._)(this,eA).delete(t.subscriptionId),t.subscriptionId=n.id,(0,S._)(this,eA).set(t.subscriptionId,t));try{o?t.listener.onOutOfDate():t.listener.onSuccessfulSubscription()}catch(e){null===(r=(0,S._)(this,eS))||void 0===r||r.error(e,"Error in onOutOfDate or onSuccessfulSubscription callback"),(0,S._)(this,eq).call(this,t,!1,e)}break;default:(0,S._)(this,eq).call(this,t,!0,n)}}}),(0,A._)(this,eF,e=>{(0,S._)(this,eV).call(this)}),(0,A._)(this,eV,()=>{if((0,S._)(this,ek)&&((0,S._)(this,ek).removeEventListener("open",(0,S._)(this,eD)),(0,S._)(this,ek).removeEventListener("message",(0,S._)(this,eL)),(0,S._)(this,ek).removeEventListener("close",(0,S._)(this,eF)),(0,S._)(this,ek).readyState!==ev.A.CLOSING&&(0,S._)(this,ek).readyState!==ev.A.CLOSED&&(0,S._)(this,ek).close(),(0,A._)(this,ek,void 0)),(0,S._)(this,eA).size>0){for(let e of(0,S._)(this,eA).values())"subscribed"===e.status&&(e.status="reconnecting");(0,em._)(this,eC,eQ).call(this)}}),(0,A._)(this,eq,(e,t,i)=>{try{e.listener.onError({subscriptionClosed:t,error:i})}catch(r){if(console.error("Error encountered in an onError callback for an OSDK subscription",r),console.error("This onError call was triggered by an error in another callback",i),console.error("The subscription has been closed.",i),!t){var a;null===(a=(0,S._)(this,eS))||void 0===a||a.error(i,"Error in onError callback"),(0,em._)(this,eI,eJ).call(this,e,"error"),(0,S._)(this,eq).call(this,e,!0,r)}}}),this.MINIMUM_RECONNECT_DELAY_MS=t,(0,A._)(this,eO,e),(0,A._)(this,eS,null===(i=e.logger)||void 0===i?void 0:i.child({},{msgPrefix:"<OSW> "})),e.baseUrl.startsWith("https://")||e.baseUrl.startsWith("http://")||(0,T.A)(!1)}}var eG={writable:!0,value:new WeakMap};async function eY(e){var t,i;try{if(await (0,em._)(this,eC,eQ).call(this),e_(e))return;e.isReady=!0,(null===(t=(0,S._)(this,ek))||void 0===t?void 0:t.readyState)===ev.A.OPEN&&(0,em._)(this,eR,eH).call(this)}catch(t){null===(i=(0,S._)(this,eS))||void 0===i||i.error(t,"Error in #initiateSubscribe"),(0,S._)(this,eq).call(this,e,!0,t)}}function eH(){var e;let t=[...(0,S._)(this,eA).values()].filter(ej),i=e1();(0,S._)(this,eE).set(i,t);let a={id:i,requests:t.map(e=>{let{objectSet:t,requestedProperties:i,requestedReferenceProperties:a,interfaceApiName:r}=e;return{objectSet:t,propertySet:i,referenceSet:a}})};null===(e=(0,S._)(this,ek))||void 0===e||e.send(JSON.stringify(a))}function eJ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"done";e_(e)||(e.status=t,e.listener=eT({}),(0,S._)(this,eA).delete(e.subscriptionId),(0,S._)(this,eM).add(e.subscriptionId),(0,em._)(this,eR,eH).call(this),(0,S._)(this,eP)&&clearTimeout((0,S._)(this,eP)),(0,A._)(this,eP,setTimeout(()=>{(0,A._)(this,eP,void 0),0===(0,S._)(this,eA).size&&(0,S._)(this,eV).call(this)},15e3)))}async function eQ(){if(null==(0,S._)(this,ek)){let{baseUrl:t,tokenProvider:i}=(0,S._)(this,eO),a=function(e,t){let i=new URL(e),a=new URL("api/v2/ontologySubscriptions/ontologies/".concat(t,"/streamSubscriptions"),i);return a.protocol=a.protocol.replace("https","wss"),a}(t,await (0,S._)(this,eO).ontologyRid),r=await i();if(null==(0,S._)(this,ek)){var e;let t=(null!==(e=(0,S._)(this,eN))&&void 0!==e?e:0)+this.MINIMUM_RECONNECT_DELAY_MS;t>Date.now()&&await new Promise(e=>{setTimeout(e,t-Date.now())}),(0,A._)(this,eN,Date.now()),null==(0,S._)(this,ek)&&((0,A._)(this,ek,new ev.A(a,["Bearer-".concat(r)])),(0,S._)(this,ek).addEventListener("close",(0,S._)(this,eF)),(0,S._)(this,ek).addEventListener("message",(0,S._)(this,eL)),(0,S._)(this,ek).addEventListener("open",(0,S._)(this,eD)))}if((0,S._)(this,ek).readyState===ev.A.CONNECTING){let e=(0,S._)(this,ek);return new Promise((t,i)=>{function a(){e.removeEventListener("open",r),e.removeEventListener("error",n),e.removeEventListener("close",a)}function r(){a(),t()}function n(e){a(),i(e)}e.addEventListener("open",r),e.addEventListener("error",n),e.addEventListener("close",a)})}}}async function eX(e,t){if(null==t)return{};let i=(await (0,S._)(this,eO).ontologyProvider.getObjectDefinition(e)).interfaceMap;return{[t]:{[e]:i[t]}}}function eZ(e){let t=(0,S._)(this,eA).get(e.id);null==t&&(0,S._)(this,eM).has(e.id)||(t||(0,T.A)(!1),(0,S._)(this,eq).call(this,t,!0,e.cause),(0,em._)(this,eI,eJ).call(this,t,"error"))}let e0=0;function e1(){return"00000000-0000-0000-0000-".concat((e0++).toString().padStart(12,"0"))}function e2(e){return"object"===e.type}function e3(e){return null!=e&&"object"==typeof e&&eh(e4.get(e))}function e5(e){return e4.get(e)}let e4=new WeakMap;function e6(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ea(e),a={aggregate:er.bind(globalThis,z(t,()=>({finalMethodCall:"aggregate"})),e,i),fetchPage:es.bind(globalThis,z(t,()=>({finalMethodCall:"fetchPage"})),e,i),fetchPageWithErrors:el.bind(globalThis,z(t,()=>({finalMethodCall:"fetchPageWithErrors"})),e,i),where:a=>t.objectSetFactory(e,t,{type:"filter",objectSet:i,where:J(a,e)}),pivotTo:function(a){return t.objectSetFactory(e,t,{type:"searchAround",objectSet:i,link:a})},union:function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];return t.objectSetFactory(e,t,{type:"union",objectSets:[i,...r.map(e=>e4.get(e))]})},intersect:function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];return t.objectSetFactory(e,t,{type:"intersect",objectSets:[i,...r.map(e=>e4.get(e))]})},subtract:function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];return t.objectSetFactory(e,t,{type:"subtract",objectSets:[i,...r.map(e=>e4.get(e))]})},nearestNeighbors:(i,a,r)=>t.objectSetFactory(e,t,{type:"nearestNeighbors",objectSet:{type:"base",objectType:e.apiName},propertyIdentifier:{type:"property",apiName:r},numNeighbors:a,query:"string"==typeof i?{type:"text",value:i}:{type:"vector",value:i}}),asyncIter:async function*(a){let r;do{let n=await es(z(t,()=>({finalMethodCall:"asyncIter"})),e,i,{...a,$nextPageToken:r});for(let e of(r=n.nextPageToken,n.data))yield e}while(null!=r)},fetchOne:e2(e)?async(a,r)=>await ed(z(t,()=>({finalMethodCall:"fetchOne"})),e,r,await e7(t,e,i,a)):void 0,fetchOneWithErrors:e2(e)?async(a,r)=>await ey(z(t,()=>({finalMethodCall:"fetchOneWithErrors"})),e,r,await e7(t,e,i,a)):void 0,subscribe:(a,r)=>{let n=ez.getInstance(t).subscribe(e,i,a,null==r?void 0:r.properties);return{unsubscribe:async()=>(await n)()}},withProperties:a=>{let r=new Map,n={};for(let t of Object.keys(a)){let i=a[t](function e(t,i,a){return{pivotTo:r=>e(t,{type:"searchAround",objectSet:i,link:r},a),where:r=>e(t,{type:"filter",objectSet:i,where:J(r,t)},a),aggregate:(e,t)=>{var r,n;let o;let s=e.split(":");2===s.length||"$count"===s[0]||(0,T.A)(!1);let[l,c]=s;switch(c){case"sum":case"avg":case"min":case"max":case"exactDistinct":case"approximateDistinct":o={type:c,selectedPropertyApiName:l};break;case"approximatePercentile":o={type:"approximatePercentile",selectedPropertyApiName:l,approximatePercentile:null!==(r=null==t?void 0:t.percentile)&&void 0!==r?r:.5};break;case"collectSet":case"collectList":o={type:c,selectedPropertyApiName:l,limit:null!==(n=null==t?void 0:t.limit)&&void 0!==n?n:100};break;case void 0:if("$count"===l){o={type:"count"};break}default:(0,T.A)(!1)}let u={type:{}};return a.set(u,{type:"selection",objectSet:i,operation:o}),u},selectProperty:e=>{let t={type:{}};return a.set(t,{type:"selection",objectSet:i,operation:{type:"get",selectedPropertyApiName:e}}),t}}}(e,{type:"methodInput"},r));n[t]=r.get(i)}return t.objectSetFactory(e,t,{type:"withProperties",derivedProperties:n,objectSet:i})},$objectSetInternals:{def:e}};return e4.set(a,i),a}async function e7(e,t,i,a){return{type:"filter",objectSet:i,where:{type:"eq",field:(await e.ontologyProvider.getObjectDefinition(t.apiName)).primaryKeyApiName,value:a}}}async function e9(e,t){if(null==e)return e;if(Array.isArray(e)||e instanceof Set){let i=Array.from(e);if(i.some(e=>G(e)||Y(e))){let e=[];for(let a of i)e.push(await e9(a,t));return e}return Promise.all(Array.from(e,async e=>await e9(e,t)))}if(G(e)){let i=await f.Tr.upload(t,e.data,{filename:e.name});return await e9(i.rid,t)}if(Y(e)){let i=await f.Tr.upload(t,e,{filename:e.name});return await e9(i.rid,t)}return e&&"object"==typeof e&&"string"==typeof e.__apiName&&null!=e.__primaryKey?await e9(e.__primaryKey,t):e&&"object"==typeof e&&"string"==typeof e.$apiName&&null!=e.$primaryKey?await e9(e.$primaryKey,t):eh(e)?e:e3(e)?e5(e):"object"==typeof e&&"string"==typeof e.mimeType&&"reference"in e&&"object"==typeof e.reference&&"mediaSetViewItem"===e.reference.type&&"mediaSetViewItem"in e.reference&&"object"==typeof e.reference.mediaSetViewItem&&"string"==typeof e.reference.mediaSetViewItem.mediaSetRid&&"string"==typeof e.reference.mediaSetViewItem.mediaSetViewRid&&"string"==typeof e.reference.mediaSetViewItem.mediaItemRid?e:null!=e&&"object"==typeof e&&"$objectType"in e&&"$primaryKey"in e?{objectTypeApiName:e.$objectType,primaryKeyValue:e.$primaryKey}:"object"==typeof e?Object.entries(e).reduce(async(e,i)=>{let[a,r]=i,n=await e;return n[a]=await e9(r,t),n},Promise.resolve({})):e}async function e8(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=q(z(e,()=>({finalMethodCall:"applyAction"})),t);if(Array.isArray(i)){let n=await f.En.applyBatch(r,await e.ontologyRid,t.apiName,{requests:i?await tt(i,e):[],options:{returnEdits:(null==a?void 0:a.$returnEdits)?"ALL":"NONE"}}),o=n.edits;return(null==a?void 0:a.$returnEdits)?(null==o?void 0:o.type)==="edits"?ti(n):o:void 0}{var n;let o=await f.En.apply(r,await e.ontologyRid,t.apiName,{parameters:await te(i,e),options:{mode:(null==a?void 0:a.$validateOnly)?"VALIDATE_ONLY":"VALIDATE_AND_EXECUTE",returnEdits:(null==a?void 0:a.$returnEdits)?"ALL_V2_WITH_DELETIONS":"NONE"}});if(null==a?void 0:a.$validateOnly)return o.validation;if((null===(n=o.validation)||void 0===n?void 0:n.result)==="INVALID")throw new u(o.validation);let s=o.edits;return(null==a?void 0:a.$returnEdits)?(null==s?void 0:s.type)==="edits"?ti(o):s:void 0}}async function te(e,t){if(null==e)return{};let i={};for(let[a,r]of Object.entries(e))i[a]=await e9(r,t);return i}async function tt(e,t){return await Promise.all(e.map(async e=>({parameters:await te(e,t)})))}function ti(e){let t=null==e?void 0:e.edits;if((null==t?void 0:t.type)==="edits"){let e={type:t.type,deletedLinksCount:t.deletedLinksCount,deletedObjectsCount:t.deletedObjectsCount,addedLinks:[],deletedLinks:[],addedObjects:[],deletedObjects:[],modifiedObjects:[],editedObjectTypes:[]},r=new Set;for(let n of t.edits){var i,a;if("addLink"===n.type||"deleteLink"===n.type){let t={linkTypeApiNameAtoB:n.linkTypeApiNameAtoB,linkTypeApiNameBtoA:n.linkTypeApiNameBtoA,aSideObject:n.aSideObject,bSideObject:n.bSideObject};"addLink"===n.type?e.addedLinks.push(t):null===(i=e.deletedLinks)||void 0===i||i.push(t),r.add(n.aSideObject.objectType),r.add(n.bSideObject.objectType)}else if("addObject"===n.type||"deleteObject"===n.type||"modifyObject"===n.type){let t={objectType:n.objectType,primaryKey:n.primaryKey};"addObject"===n.type?e.addedObjects.push(t):"deleteObject"===n.type?null===(a=e.deletedObjects)||void 0===a||a.push(t):"modifyObject"===n.type&&e.modifiedObjects.push(t),r.add(n.objectType)}}return e.editedObjectTypes=[...r],e}}let ta=Symbol("additionalContext");Symbol("ErrorMessage");let tr=new Uint8Array([123,34,100,97,116,97,34,58,91]);async function*tn(e){let t=new TextDecoder("utf-8"),i=!1,a=[],r=0;for await(let n of e){let e=0;for(!i&&(i=!0,function(e,t){if(e.length<t.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0}(n,tr)&&(e=tr.length));e<n.length;e++){for(;0===r&&123!==n[e]&&e<n.length;)e++;let i=e;for(;i<n.length;i++){let o=n[i];if(123===o)r++;else if(125===o&&0==--r){yield function(e,t,i){let a="";for(let i of t)a+=e.decode(i,{stream:!0});return JSON.parse(a+=e.decode(i))}(t,a,n.subarray(e,i+1)),a=[],e=i;break}}if(i===n.length){a.push(n.subarray(e));break}}}}async function*to(e){let t=await e.read();for(;!t.done;)yield t.value,t=await e.read()}function ts(e){return"$startTime"in e||"$endTime"in e?{type:"absolute",startTime:e.$startTime,endTime:e.$endTime}:e.$before?{type:"relative",startTime:{when:"BEFORE",value:e.$before,unit:s[e.$unit]}}:{type:"relative",endTime:{when:"AFTER",value:e.$after,unit:s[e.$unit]}}}async function*tl(e){var t;for await(let i of tn(to(null===(t=e.body)||void 0===t?void 0:t.getReader())))yield{time:i.time,value:i.value}}var tc=new WeakMap,tu=new WeakMap;class tp{async getLatestValue(){let e=f.FK.getLatestValue((0,S._)(this,tu),await (0,S._)(this,tu).ontologyRid,...(0,S._)(this,tc));return e.then(e=>this.lastFetchedValue=e,e=>void console.error(e)),e}async getAllValues(e){let t=[];for await(let i of this.asyncIterValues(e))t.push(i);return t}async *asyncIterValues(e){for await(let t of tl(await f.FK.streamValues((0,S._)(this,tu),await (0,S._)(this,tu).ontologyRid,...(0,S._)(this,tc),e?{range:ts(e)}:{})))yield t}constructor(e,t,i,a,r){(0,E._)(this,tc,{writable:!0,value:void 0}),(0,E._)(this,tu,{writable:!0,value:void 0}),(0,A._)(this,tu,e),(0,A._)(this,tc,[t,i,a]),null!=r&&(this.lastFetchedValue=r)}}var td=new WeakMap,ty=new WeakMap;class tf{async fetchContents(){return f.NG.getMediaContent((0,S._)(this,ty),await (0,S._)(this,ty).ontologyRid,...(0,S._)(this,td),{preview:!0})}async fetchMetadata(){let e=await f.NG.getMediaMetadata((0,S._)(this,ty),await (0,S._)(this,ty).ontologyRid,...(0,S._)(this,td),{preview:!0});return{path:e.path,sizeBytes:Number(e.sizeBytes),mediaType:e.mediaType}}constructor(e){(0,E._)(this,td,{writable:!0,value:void 0}),(0,E._)(this,ty,{writable:!0,value:void 0});let{client:t,objectApiName:i,primaryKey:a,propertyName:r}=e;(0,A._)(this,ty,t),(0,A._)(this,td,[i,a,r])}}var th=new WeakMap,tm=new WeakMap;class tb{async getFirstPoint(){return f.MB.getFirstPoint((0,S._)(this,tm),await (0,S._)(this,tm).ontologyRid,...(0,S._)(this,th))}async getLastPoint(){return f.MB.getLastPoint((0,S._)(this,tm),await (0,S._)(this,tm).ontologyRid,...(0,S._)(this,th))}async getAllPoints(e){let t=[];for await(let i of this.asyncIterPoints(e))t.push(i);return t}async *asyncIterPoints(e){for await(let t of tl(await f.MB.streamPoints((0,S._)(this,tm),await (0,S._)(this,tm).ontologyRid,...(0,S._)(this,th),e?{range:ts(e)}:{})))yield t}constructor(e,t,i,a){(0,E._)(this,th,{writable:!0,value:void 0}),(0,E._)(this,tm,{writable:!0,value:void 0}),(0,A._)(this,tm,e),(0,A._)(this,th,[t,i,a])}}function tg(e,t){return{rid:t,fetchContents:async()=>f.Tr.read(e,t),async fetchMetadata(){let i=await f.Tr.get(e,t);return{...i,sizeBytes:Number(i.sizeBytes)}}}}let tv=Symbol("InterfaceDefinitions"),tw=Symbol("Underlying Object"),tT=Symbol("ObjectDefinition"),tj=Symbol("InterfaceDefinition"),t_=Symbol("ClientRef"),tk=M(new WeakMap,function(e){return function(t){var i,a;let r;if("string"==typeof t){if(t===e.apiName)return this[tw];if((null===(a=e.interfaceMap)||void 0===a?void 0:a[t])==null)throw Error("Object does not implement interface '".concat(t,"'."));r=t}else{if(t.apiName===e.apiName)return this[tw];if("object"===t.type)throw Error("'".concat(t.apiName,"' is not an interface nor is it '").concat(e.apiName,"', which is the object type."));r=t.apiName}let n=e[tv][r];if(!n)throw Error("Object does not implement interface '".concat(r,"'."));let o=this[tw],s=null===(i=tN.get(o).get(r))||void 0===i?void 0:i.deref();if(s)return s;let l=function(e,t){let[i]=H(t.apiName);return Object.freeze(Object.defineProperties({},{[tw]:{value:e},$apiName:{value:t.apiName,enumerable:!0},$as:{value:e.$as,enumerable:!1},$objectType:{value:e.$objectType,enumerable:"$objectType"in e},$primaryKey:{value:e.$primaryKey,enumerable:"$primaryKey"in e},$title:{value:e.$title,enumerable:"$title"in e},$rid:{value:e.$rid,enumerable:"$rid"in e},$clone:{value:function(i){if(null==i)return e.$clone().$as(t);for(let e of Object.keys(i))if(!(e in t.properties))throw Error("Invalid property ".concat(e," for interface ").concat(t.apiName));let a=Object.fromEntries(Object.keys(i).map(a=>(function(i,a){let r=e[tT],n=r.interfaceMap[t.apiName][i];if(null==n)throw Error("Cannot clone interface with ".concat(i," as property is not implemented by the underlying object type ").concat(r.apiName));return[n,a]})(a,i[a])).filter(e=>null!=e));return e.$clone(a).$as(t)},enumerable:!1},[tj]:{value:t},...Object.fromEntries(Object.keys(t.properties).map(a=>{let r=e[tT],[n,o]=H(a),s=r.interfaceMap[t.apiName][a];return[n===i?o:a,{enumerable:s in e,value:e[s]}]}))}))}(o,n.def);return tN.get(o).set(r,new WeakRef(l)),l}}).get,tN=M(new WeakMap,()=>new Map),tO=new Set(["attachment","geotimeSeriesReference","mediaReference","numericTimeseries","stringTimeseries","sensorTimeseries"]),tS={$as:{get:function(){return tk(this[tT])}},$link:{get:function(){return function(e){let t=e[t_],i=e[tT],a=e[tw];return Object.freeze(Object.fromEntries(Object.keys(i.links).map(e=>{let r=i.links[e],n=t.objectSetFactory(i,t).where({[i.primaryKeyApiName]:a.$primaryKey}).pivotTo(e);return[e,r.multiplicity?n:{fetchOne:e=>ed(t,i,null!=e?e:{},e5(n)),fetchOneWithErrors:e=>ey(t,i,null!=e?e:{},e5(n))}]})))}(this)}},$clone:{value:function(e){let t=this[tw],i=this[tT];if(null==e)return tE(this[t_],i,{...t});if(i.primaryKeyApiName in e&&t[i.primaryKeyApiName]!==e[i.primaryKeyApiName])throw Error("Cannot update ".concat(i.apiName," object with differing primary key values "));i.titleProperty in e&&!("$title"in e)&&(e.$title=e[i.titleProperty]);let a={...this[tw],...e};return tE(this[t_],this[tT],a)}}};function tE(e,t,i){for(let a of(Object.defineProperties(i,{[tw]:{enumerable:!1,value:i},[tT]:{value:t,enumerable:!1},[t_]:{value:e,enumerable:!1},...tS}),Object.keys(i)))a in t.properties&&"string"==typeof t.properties[a].type&&tO.has(t.properties[a].type)&&(i[a]=function(e,t,i,a){let r=i[a],n=t.properties[a];return"attachment"===n.type?Array.isArray(r)?r.map(t=>tg(e,t.rid)):tg(e,r.rid):"numericTimeseries"===n.type||"stringTimeseries"===n.type||"sensorTimeseries"===n.type?new tb(e,t.apiName,i[t.primaryKeyApiName],a):"geotimeSeriesReference"===n.type?new tp(e,t.apiName,i[t.primaryKeyApiName],a,"geotimeSeriesValue"===r.type?{time:r.timestamp,value:{type:"Point",coordinates:r.position}}:void 0):"mediaReference"===n.type?new tf({client:e,objectApiName:t.apiName,primaryKey:i[t.primaryKeyApiName],propertyName:a}):void 0}(e,t,i,a));return Object.freeze(i)}async function tA(e,t,i){var a,r;let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];null===(a=e.logger)||void 0===a||a.debug("START convertWireToOsdkObjects()"),tR(t,n);let l=i?await e.ontologyProvider.getInterfaceDefinition(i):void 0,c=l?null!=o?o:Object.keys(l.properties):void 0,u=[];for(let a of t){let t;let r=await e.ontologyProvider.getObjectDefinition(a.$apiName);r||(0,T.A)(!1);let n=!0;if(l&&c?(t$(r,l.apiName,e),n&&(n=tP(e,l,a,c)),function(e,t,i){let a={};for(let[r,n]of Object.entries(e.interfaceMap[t]))if(r in i){let e=i[r];delete i[r],void 0!==e&&(a[n]=e)}Object.assign(i,a),e.primaryKeyApiName in i||(i[e.primaryKeyApiName]=i.$primaryKey)}(r,l.apiName,a),t=function(e,t,i){return i.map(i=>e.interfaceMap[t][i])}(r,l.apiName,c)):t=null!=o?o:Object.keys(r.properties),n&&(n=tP(e,r,a,t)),"throw"!==s||n){if("drop"===s&&!n)continue}else throw Error("Unable to safely convert objects as some non nullable properties are null");let p=tE(e,r,a);i&&(p=p.$as(i)),u.push(p)}return null===(r=e.logger)||void 0===r||r.debug("END convertWireToOsdkObjects()"),u}async function tM(e,t,i){var a,r;let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};null===(a=e.logger)||void 0===a||a.debug("START convertWireToOsdkObjects2()"),tR(t,n);let c=[];for(let a of t){let t;let r=await e.ontologyProvider.getObjectDefinition(a.$apiName);r||(0,T.A)(!1);let n=i?l[i][a.$apiName]:void 0,u=i&&n?o?Object.keys(n).filter(e=>{null==o||o.includes(n[e])}):[...Object.values(n),r.primaryKeyApiName]:void 0,p=!0;if(i&&u?(t$(r,i,e),t=u):t=null!=o?o:Object.keys(r.properties),p&&(p=tP(e,r,a,t)),"throw"!==s||p){if("drop"===s&&!p)continue}else throw Error("Unable to safely convert objects as some non nullable properties are null");let d=tE(e,r,a);i&&(d=d.$as(i)),c.push(d)}return null===(r=e.logger)||void 0===r||r.debug("END convertWireToOsdkObjects2()"),c}function tP(e,t,i,a){for(let e of a)if(e in t.properties&&!1===t.properties[e].nullable&&null==i[e])return!1;return!0}function t$(e,t,i){var a;if((null===(a=e.interfaceMap)||void 0===a?void 0:a[t])==null){let e="Interfaces are only supported 'as views' but your metadata object is missing the correct information. This suggests your interfaces have not been migrated to the newer version yet and you cannot use this version of the SDK.";throw i.logger?i.logger.warn(e):console.error("WARNING! ".concat(e)),Error(e)}}function tR(e,t){for(let o of e){var i,a,r,n;t&&delete o.__rid,o.__rid&&(o.$rid=o.__rid,delete o.__rid),null!==(i=o.$apiName)&&void 0!==i||(o.$apiName=o.__apiName),o.$objectType=o.$apiName,null!==(a=o.$primaryKey)&&void 0!==a||(o.$primaryKey=o.__primaryKey),null!==(r=o.$title)&&void 0!==r||(o.$title=o.__title),o.__score&&(null!==(n=o.$score)&&void 0!==n||(o.$score=o.__score),delete o.__score),delete o.__apiName,delete o.__primaryKey,delete o.__title}}function tI(e){let t=new WeakMap;function i(e,i,a){return null==t.get(e.clientCacheKey)&&t.set(e.clientCacheKey,new Map),t.get(e.clientCacheKey).set(i,a),a}return{get:function(a,r){null==t.get(a.clientCacheKey)&&t.set(a.clientCacheKey,new Map);let n=t.get(a.clientCacheKey).get(r);return void 0===n&&void 0!==e?i(a,r,e(a,r)):n},set:i,remove:function(e,i){return null!=t.get(e.clientCacheKey)&&t.get(e.clientCacheKey).delete(i)}}}async function tC(e,t){return function(e){let t=function(e){let t=new Set,i=new Set;for(let a of e.operations)switch(a.type){case"createObject":t.add(a.objectTypeApiName);break;case"modifyObject":i.add(a.objectTypeApiName)}return{addedObjects:t,modifiedObjects:i}}(e);return{type:"action",apiName:e.apiName,parameters:Object.fromEntries(Object.entries(e.parameters).map(e=>{let[t,i]=e;return[t,{multiplicity:"array"===i.dataType.type,type:function e(t){switch(t.type){case"string":case"boolean":case"attachment":case"double":case"integer":case"long":case"timestamp":case"mediaReference":case"marking":case"objectType":return t.type;case"date":return"datetime";case"objectSet":return{type:"objectSet",objectSet:t.objectTypeApiName};case"object":return{type:"object",object:t.objectTypeApiName};case"array":return e(t.subType);case"interfaceObject":return{type:"interface",interface:t.interfaceTypeApiName};case"struct":return{type:"struct",struct:t.fields.reduce((t,i)=>(t[i.name]=e(i.fieldType),t),{})};default:throw Error("Unsupported action parameter type: ".concat(JSON.stringify(t)))}}("array"===i.dataType.type?i.dataType.subType:i.dataType),nullable:!i.required,description:i.description}]})),displayName:e.displayName,description:e.description,modifiedEntities:function(e,t){let i={};for(let t of e)i[t]={created:!0,modified:!1};for(let e of t)i[e]?i[e].modified=!0:i[e]={created:!1,modified:!0};return i}(t.addedObjects,t.modifiedObjects),rid:e.rid,status:e.status}}(await f.UL.get(e,await e.ontologyRid,t))}function tD(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,a=function e(t,i){switch(t.type){case"integer":case"string":case"byte":case"decimal":case"double":case"float":case"long":case"short":case"boolean":case"attachment":case"geopoint":case"geoshape":case"timestamp":case"marking":case"geotimeSeriesReference":case"vector":case"mediaReference":return t.type;case"date":return"datetime";case"array":return e(t.subType);case"timeseries":var a,r;if((null===(a=t.itemType)||void 0===a?void 0:a.type)==="string")return"stringTimeseries";if((null===(r=t.itemType)||void 0===r?void 0:r.type)==="double")return"numericTimeseries";return"sensorTimeseries";case"struct":return t.structFieldTypes.reduce((t,i)=>(t[i.apiName]=e(i.dataType),t),{});case"cipherText":null==i||i.info("".concat(JSON.stringify(t.type)," is not a supported propertyType"));return;default:null==i||i.info("".concat(JSON.stringify(t)," is not a supported propertyType"));return}}(e.dataType,i);if(null!=a)switch(e.dataType.type){case"integer":case"string":case"byte":case"decimal":case"double":case"float":case"long":case"short":case"boolean":case"date":case"attachment":case"mediaReference":case"geopoint":case"geoshape":case"timestamp":case"timeseries":case"marking":case"geotimeSeriesReference":case"vector":case"struct":return{displayName:e.displayName,multiplicity:!1,description:e.description,type:a,nullable:null==e.nullable?t:e.nullable};case"array":return{displayName:e.displayName,multiplicity:!0,description:e.description,type:a,nullable:!0};case"cipherText":null==i||i.info("".concat(JSON.stringify(e.dataType.type)," is not a supported dataType"));return;default:e.dataType,null==i||i.info("".concat(JSON.stringify(e.dataType)," is not a supported dataType"));return}}let tL=["blueprint"];async function tx(e,t){var i;let a=function(e,t,i){if(void 0===e.objectType.properties[e.objectType.primaryKey])throw Error("Primary key ".concat(e.objectType.primaryKey," not found in ").concat(e.objectType.apiName));if(null==e.implementsInterfaces2&&null!=e.implementsInterfaces)throw Error("Your ontology.json file is missing the implementsInterfaces2 field. Please regenerate it.");let a=e.implementsInterfaces2?Object.fromEntries(Object.entries(e.implementsInterfaces2).map(e=>{let[t,i]=e;return[t,i.properties]})):{};return{type:"object",apiName:e.objectType.apiName,description:e.objectType.description,primaryKeyApiName:e.objectType.primaryKey,primaryKeyType:function(e){switch(e.dataType.type){case"integer":case"double":case"string":case"boolean":case"byte":case"long":case"short":return e.dataType.type;case"date":return"datetime";case"timestamp":return"timestamp";case"geopoint":case"geoshape":case"decimal":case"attachment":case"timeseries":case"array":case"marking":case"float":case"geotimeSeriesReference":case"mediaReference":case"struct":case"cipherText":case"vector":throw Error("Type not supported for primaryKey: ".concat(e.dataType.type));default:throw e.dataType,Error("Unknown type encountered for primaryKey: ".concat(e.dataType))}}(e.objectType.properties[e.objectType.primaryKey]),links:Object.fromEntries(e.linkTypes.map(e=>[e.apiName,{multiplicity:"MANY"===e.cardinality,targetType:e.objectTypeApiName}])),properties:Object.fromEntries(Object.entries(e.objectType.properties).map(i=>{let[a,r]=i;return[a,tD(r,!(t&&e.objectType.primaryKey===a),void 0)]}).filter(e=>{let[t,i]=e;return null!=i})),implements:e.implementsInterfaces,interfaceMap:a,inverseInterfaceMap:Object.fromEntries(Object.entries(a).map(e=>{let[t,i]=e;return[t,i?Object.fromEntries(Object.entries(i).map(e=>{let[t,i]=e;return[i,t]})):void 0]})),icon:tL.includes(e.objectType.icon.type)?e.objectType.icon:void 0,titleProperty:e.objectType.titleProperty,displayName:e.objectType.displayName,pluralDisplayName:e.objectType.pluralDisplayName,status:e.objectType.status,rid:e.objectType.rid,visibility:e.objectType.visibility}}(await f.Tq.getFullMetadata(e,await e.ontologyRid,t,{preview:!0}),!0);return null===(i=e.logger)||void 0===i||i.debug("END loadFullObjectMetadata(".concat(t,")")),{...a}}async function tK(e,t){var i,a,r;return{type:"interface",rid:(i=await f.Y7.get(e,await e.ontologyRid,t,{preview:!0})).rid,apiName:i.apiName,displayName:i.displayName,description:i.description,implements:null!==(a=i.allExtendsInterfaces)&&void 0!==a?a:i.extendsInterfaces,properties:Object.fromEntries(Object.entries(null!==(r=i.allProperties)&&void 0!==r?r:i.properties).map(e=>{let[t,i]=e;return[t,tD(i,!0,void 0)]}).filter(e=>{let[t,i]=e;return null!=i})),links:{},implementedBy:i.implementedByObjectTypes}}function tW(e){switch(e.type){case"double":case"float":case"integer":case"long":case"attachment":case"boolean":case"date":case"string":case"timestamp":return{type:e.type,nullable:!1};case"object":return{type:"object",object:e.objectTypeApiName,nullable:!1};case"objectSet":return{type:"objectSet",objectSet:e.objectTypeApiName,nullable:!1};case"array":return{...tW(e.subType),multiplicity:!0};case"set":return{type:"set",set:tW(e.subType),nullable:!1};case"union":let t=function e(t){return"null"===t.type||"union"===t.type&&t.unionTypes.some(t=>e(t))}(e);if(t&&2===e.unionTypes.length){let t=e.unionTypes.find(e=>null!=e.type);if(t)return{...tW(t),nullable:!0}}return{type:"union",union:e.unionTypes.reduce((e,t)=>("null"===t.type||e.push(tW(t)),e),[]),nullable:t};case"struct":return{type:"struct",struct:Object.fromEntries(e.fields.map(e=>[e.name,tW(e.fieldType)])),nullable:!1};case"twoDimensionalAggregation":return{type:"twoDimensionalAggregation",twoDimensionalAggregation:tU(e),nullable:!1};case"threeDimensionalAggregation":return{type:"threeDimensionalAggregation",threeDimensionalAggregation:function(e){if("range"===e.keyType.type)return{keyType:e.keyType.type,keySubtype:e.keyType.subType.type,valueType:tU(e.valueType)};if(tB(e.keyType))return{keyType:e.keyType.type,valueType:tU(e.valueType)};throw Error("Cannot create 3D aggregation with ".concat(e.keyType.type," as its type"))}(e),nullable:!1};case"entrySet":case"null":case"unsupported":throw Error("Unable to process query because the server indicated an unsupported QueryDataType.type: ".concat(e.type,". Please check that your query is using supported types."));default:throw Error("Unsupported QueryDataType.type ".concat(e.type))}}function tU(e){if("range"===e.keyType.type)return{keyType:e.keyType.type,keySubtype:e.keyType.subType.type,valueType:e.valueType.type};if(tB(e.keyType))return{keyType:e.keyType.type,valueType:e.valueType.type};throw Error("Cannot create 2D aggregation with ".concat(e.keyType.type," as its type"))}function tB(e){return"string"===e.type||"boolean"===e.type}async function tF(e,t){var i;return{type:"query",apiName:(i=await f.Ib.get(e,await e.ontologyRid,t)).apiName,description:i.description,displayName:i.displayName,version:i.version,parameters:Object.fromEntries(Object.entries(i.parameters).map(e=>{let[t,i]=e;return[t,{description:i.description,...tW(i.dataType)}]})),output:tW(i.output),rid:i.rid}}let tV=()=>e=>{function t(t){let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tI,i=t(),a=t(),r={getOrUndefined:function(e,t){return i.get(e,t)},get:async function(t,n){var o,s;return null!==(s=null!==(o=i.get(t,n))&&void 0!==o?o:a.get(t,n))&&void 0!==s?s:r.set(t,n,e(t,n))},set:async function(e,t,r){try{let n=await a.set(e,t,r);return i.set(e,t,n),a.remove(e,t),n}catch(i){throw a.remove(e,t),i}}};return r}((e,i)=>t(e,i,!1));return async t=>await i.get(e,t)}let i={getObjectDefinition:t(async function(e,t){var a,r;let n=await tx(e,t),o=Object.fromEntries((await Promise.all(null!==(r=null===(a=n.implements)||void 0===a?void 0:a.map(e=>i.getInterfaceDefinition(e)))&&void 0!==r?r:[])).map(e=>[e.apiName,{def:e,handler:void 0}]));return{...n,[tv]:o}}),getInterfaceDefinition:t(async function(e,t){return tK(e,t)}),getQueryDefinition:t(async function(e,t){return await tF(e,t)}),getActionDefinition:t(async function(e,t){return await tC(e,t)})};return i},tq=async(e,t)=>{if("object"===t.type){let{[tv]:i,...a}=await e.ontologyProvider.getObjectDefinition(t.apiName);return a}if("interface"===t.type)return e.ontologyProvider.getInterfaceDefinition(t.apiName);if("action"===t.type)return e.ontologyProvider.getActionDefinition(t.apiName);if("query"===t.type)return e.ontologyProvider.getQueryDefinition(t.apiName);throw Error("Not implemented for given definition")};async function tz(e,t,i){if(null==e)return e;if(Array.isArray(e)&&i.multiplicity){let a=Array.from(e);if(a.some(e=>G(e)||Y(e))){let e=[];for(let r of a)e.push(await tz(r,t,i));return e}return Promise.all(Array.from(e,async e=>await tz(e,t,i)))}switch(i.type){case"attachment":if(G(e))return(await f.Tr.upload(t,e.data,{filename:e.name})).rid;if(Y(e))return(await f.Tr.upload(t,e,{filename:e.name})).rid;break;case"twoDimensionalAggregation":case"threeDimensionalAggregation":return{groups:e};case"set":if(e instanceof Set)return Promise.all(Array.from(e,async e=>await tz(e,t,i.set)));break;case"object":if(e&&"object"==typeof e&&"string"==typeof e.$apiName&&null!=e.$primaryKey)return e.$primaryKey;break;case"objectSet":if(eh(e))break;if(e3(e))return e5(e);break;case"struct":if("object"==typeof e){let a={};for(let[r,n]of Object.entries(e))a[r]=await tz(n,t,i.struct[r]);return a}}return e}async function tG(e,t,i){let a=await e.ontologyProvider.getQueryDefinition(t.apiName),r=await f.RT.execute(q(z(e,()=>({finalMethodCall:"applyQuery"})),t),await e.ontologyRid,t.apiName,{parameters:i?await tY(i,e,a.parameters):{}}),n=await tJ(a.output,e);return await tH(e,a.output,r.value,n)}async function tY(e,t,i){let a={};for(let[r,n]of Object.entries(e))a[r]=await tz(n,t,i[r]);return a}async function tH(e,t,i,a){if(null==i){if(t.nullable)return;throw Error("Got null response when nullable was not allowed")}if(null!=t.multiplicity&&t.multiplicity){let r={...t,multiplicity:!1};for(let t=0;t<i.length;t++)i[t]=await tH(e,r,i[t],a);return i}switch(t.type){case"union":throw Error("Union return types are not yet supported");case"set":for(let r=0;r<i.length;r++)i[r]=await tH(e,t.set,i[r],a);break;case"attachment":return tg(e,i);case"object":{let e=a.get(t.object);if(!e)throw Error("Missing definition for ".concat(t.object));return{$apiName:e.apiName,$title:void 0,$objectType:e.apiName,$primaryKey:i}}case"objectSet":{let r=a.get(t.objectSet);if(!r)throw Error("Missing definition for ".concat(t.objectSet));if("string"==typeof i)return e6(r,e,{type:"intersect",objectSets:[{type:"base",objectType:t.objectSet},{type:"reference",reference:i}]});return e6(r,e,i)}case"struct":for(let[r,n]of Object.entries(t.struct))(function e(t){switch(t.type){case"boolean":case"date":case"double":case"float":case"integer":case"long":case"string":case"timestamp":default:return!1;case"union":case"attachment":case"objectSet":case"twoDimensionalAggregation":case"threeDimensionalAggregation":case"object":return!0;case"struct":return Object.values(t.struct).some(e);case"set":return e(t.set)}})(n)&&(i[r]=await tH(e,n,i[r],a));break;case"twoDimensionalAggregation":{let e=[];for(let{key:t,value:a}of i.groups)e.push({key:t,value:a});return e}case"threeDimensionalAggregation":{let e=[];for(let{key:t,groups:a}of i.groups){let i=[];for(let{key:e,value:t}of a)i.push({key:e,value:t});e.push({key:t,groups:i})}return e}}return i}async function tJ(e,t){let i=new Map;switch(e.type){case"objectSet":{let a=await t.ontologyProvider.getObjectDefinition(e.objectSet);i.set(e.objectSet,a);break}case"object":{let a=await t.ontologyProvider.getObjectDefinition(e.object);i.set(e.object,a);break}case"set":return tJ(e.set,t);case"struct":for(let a of Object.values(e.struct))for(let[e,r]of(await tJ(a,t)))i.set(e,r)}return i}class tQ{constructor(e,t){this.applyAction=e8.bind(void 0,e,t),this.batchApplyAction=e8.bind(void 0,e,t)}}class tX{constructor(e,t){this.executeFunction=tG.bind(void 0,e,t)}}(function(e,t,i,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:fetch;if("string"==typeof i){if(!i.startsWith("ri."))throw Error("Invalid ontology RID")}else i.then(e=>{if(!e.startsWith("ri."))throw Error("Invalid ontology RID")});let o=function(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:global.fetch,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e6,o=new URL(t);o.pathname+=o.pathname.endsWith("/")?"":"/";let s={...function(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fetch;if(0===e.length)throw Error("baseUrl cannot be empty");let r=F(V(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fetch;return async function(t,i){let a;try{a=await e(t,i)}catch(e){throw function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An unknown error occurred";return e instanceof Error?new c(e.message,"UNKNOWN",e):new c(t,"UNKNOWN")}(e,"A network error occurred")}if(!a.ok){var r;let e;if("text/plain"===a.headers.get("Content-Type"))throw new l(await a.text());try{e=await a.json()}catch(e){throw new l("Failed to fetch ".concat(a.status," ").concat(a.statusText),"UNKNOWN",void 0,a.status)}throw new l(null!==(r=null==e?void 0:e.message)&&void 0!==r?r:"Failed to fetch ".concat(a.status," ").concat(a.statusText),null==e?void 0:e.errorName,null==e?void 0:e.errorCode,a.status,null==e?void 0:e.errorInstanceId,null==e?void 0:e.parameters)}return a}}(a),{retryDelay(e){let t=1e3*2**e,i=.5*t*(2*Math.random()-1);return t+i},retryOn(e,t,i){var a;let r=null!==(a=null==i?void 0:i.status)&&void 0!==a?a:0;return!(r>=200&&r<300)&&(!(t instanceof l)||503===t.statusCode||429===t.statusCode)&&e<3}}),async e=>{let a=await t();return e.set("Authorization","Bearer ".concat(a)),e.set("Fetch-User-Agent",[e.get("Fetch-User-Agent"),i].filter(e=>e&&(null==e?void 0:e.length)>0).join(" ")),e});return{baseUrl:e,fetch:async(e,t)=>{try{return await r(e,t)}catch(t){var i;let e=t instanceof l?new l(t.message,t.errorName,t.errorCode,t.statusCode,t.errorInstanceId,t.parameters):Error("Captured stack trace for error: "+(null!==(i=t.message)&&void 0!==i?i:t));throw e.cause=t,e}},tokenProvider:t}}(o.toString(),i,"osdk-client/2.2.0-beta.7",r),objectSetFactory:n,objectFactory:tA,objectFactory2:tM,ontologyRid:e.ontologyRid,logger:a.logger,clientCacheKey:{},requestContext:{}};return Object.freeze(Object.assign(s,{ontologyProvider:tV(a)(s)}))}({ontologyRid:i},t,a,r,n,e),s=tq.bind(void 0,o);return Object.defineProperties(function(t){if("object"===t.type||"interface"===t.type)return e(t,o);if("action"===t.type)return new tQ(o,t);if("query"===t.type)return new tX(o,t);if("experiment"===t.type)switch(t.name){case y.name:return{getBulkLinks:async function*(e,t){var i;if(0===e.length)return;null===(i=o.logger)||void 0===i||i.debug("Preparing to fetch bulk links"),e.every(t=>t.$objectType===e[0].$objectType)||(0,T.A)(!1);let a=await U(o),r=await a.forObjectByApiName(e[0].$objectType),[n,s,l]=await Promise.all([r.getRid(),r.getPropertyMapping(),r.getLinkMapping()]),c=Object.fromEntries(Object.entries(l).filter(e=>{let[i]=e;return t.includes(i)}));for(let e of t)if(null==c[e])throw"Unable to find link type: "+e;let u={objectSetContext:{forkRid:void 0,objectSetFilterContext:{parameterOverrides:{}},ontologyBranchRid:void 0,owningRid:void 0,reportUsage:void 0,workstateRid:void 0},responseOptions:{includeObjectSetEntities:!0,includeUsageCost:!1},pageSize:1e3,pageToken:void 0,linksRequests:[{directedLinkTypes:Object.values(c).map(e=>{let{directedLinkTypeRid:t}=e;return t}),objects:j("objects",e.map(e=>j("objectLocatorV2",{objectTypeRid:n,objectPrimaryKey:{[s.pk.rid]:j(s.pk.type.type,e.$primaryKey)}})))}]};for await(let t of O(b.bind(void 0,_(o,"object-set-service/api")),k,N,u)){let{objectIdentifier:i}=t,r=function(e,t){let{pkValue:i}=B(e),a=t.find(e=>e.$primaryKey===i);if(null==a)throw Error("Needed to find object with pk ".concat(i,"} and could not"));return a}(i,e);for(let e of t.links){let t=B(e.link["SOURCE"===e.linkSide?"objectSideB":"objectSideA"]),i=await (await a.forObjectByRid(t.objectTypeRid)).getApiName(),n=Object.values(c).find(t=>t.directedLinkTypeRid.linkTypeRid===e.link.linkTypeRid&&t.directedLinkTypeRid.linkSide===e.linkSide);if(!n)throw Error("Could not find link type");yield{object:r,linkApiName:n.apiName,otherObjectApiName:i,otherObjectPk:t.pkValue}}}}};case d.name:return{fetchOneByRid:async(e,t,i)=>await ed(o,e,i,{type:"static",objects:[t]})};case p.name:return{createMediaReference:async e=>{let{data:t,fileName:i,objectType:a,propertyType:r}=e;return await f.NG.upload(o,await o.ontologyRid,a.apiName,r,t,{mediaItemPath:i,preview:!0})}}}throw Error("not implemented")},{[h.j]:{value:o},__osdkClientContext:{value:o},[ta]:{value:o},fetchMetadata:{value:s}})}).bind(void 0,e6),i(6015);var tZ=i(4570),t0=i(6623);function t1(e){if((0,tZ.AJ)(e))throw Error("Failed to get token: ".concat(e.error));return e}let t2=globalThis.CustomEvent;function t3(e){return"@osdk/oauth : refresh : ".concat(e.client_id)}function t5(e,t){var i;null===(i=globalThis.localStorage)||void 0===i||i.setItem(t3(e),JSON.stringify(t))}function t4(e){var t;null===(t=globalThis.localStorage)||void 0===t||t.removeItem(t3(e))}function t6(e,t){var i;null===(i=globalThis.sessionStorage)||void 0===i||i.setItem(t3(e),JSON.stringify(t))}function t7(e){var t,i;return JSON.parse(null!==(i=null===(t=globalThis.sessionStorage)||void 0===t?void 0:t.getItem(t3(e)))&&void 0!==i?i:"{}")}var t9=i(8281);let t8="https://fake.palantirfoundry.com",ie="https://example.com/auth/callback";ii(t8,"NEXT_PUBLIC_FOUNDRY_API_URL"),ii("123","NEXT_PUBLIC_FOUNDRY_CLIENT_ID"),ii(ie,"NEXT_PUBLIC_FOUNDRY_REDIRECT_URL");let it=["api:ontologies-read","api:ontologies-write"];function ii(e,t){if(null==e)throw Error("Missing environment variable: ".concat(t))}let ia=null,ir=()=>(null==ia&&(ia=function(e,t,i,a,r,n,o,s,l){var c,u,p,d,y,f,h,m,b,g;let v,w;({useHistory:a,loginPage:r,postLoginPage:n,scopes:o,fetchFn:s,ctxPath:l,refreshTokenMarker:v}=(c=a,u=r,p=n,d=o,y=s,f=l,w={},"object"==typeof c?((u||p||d||y||f)&&(0,T.A)(!1),w=c):w={useHistory:c,loginPage:u,postLoginPage:p,scopes:d,fetchFn:y,ctxPath:f},t||(0,T.A)(!1),i||(0,T.A)(!1),{useHistory:null===(h=w.useHistory)||void 0===h||h,loginPage:w.loginPage,postLoginPage:w.postLoginPage||window.location.toString(),scopes:null!==(m=w.scopes)&&void 0!==m?m:["api:read-data","api:write-data"],fetchFn:null!==(b=w.fetchFn)&&void 0!==b?b:globalThis.fetch,ctxPath:null!==(g=w.ctxPath)&&void 0!==g?g:"multipass",refreshTokenMarker:w.refreshTokenMarker}));let j={client_id:"123",token_endpoint_auth_method:"none"},_=function(e,t){let i="".concat(new URL(e,t.endsWith("/")?t:t+"/"));return{token_endpoint:"".concat(i,"/api/oauth2/token"),authorization_endpoint:"".concat(i,"/api/oauth2/authorize"),revocation_endpoint:"".concat(i,"/api/oauth2/revoke_token"),issuer:i}}(l,t),k={[tZ.A6]:s},{makeTokenAndSaveRefresh:N,getToken:O}=function(e,t,i,a,r,n){let o,s,l;let c=new t0.m;function u(){s&&clearTimeout(s)}function p(e){r&&(u(),s=setTimeout(r,1e3*e.detail.expires_in-6e4))}async function d(){if(l)return l;try{return l=i(),await l}finally{l=void 0}}return c.addEventListener("signIn",p),c.addEventListener("refresh",p),{getToken:Object.assign(async function(){return(!o||Date.now()>=o.expires_at)&&(o=await d()),null==o?void 0:o.access_token},{signIn:d,refresh:r,signOut:async function(){o||(0,T.A)(!1);let i=await (0,tZ.TP)(await (0,tZ.Kz)(t,e,o.access_token,a));u(),t4(e),o=void 0,t1(i),c.dispatchTypedEvent("signOut",new Event("signOut"))},rmTimeout:u,getTokenOrUndefined:function(){if(!(!o||Date.now()>=o.expires_at))return null==o?void 0:o.access_token},addEventListener:c.addEventListener.bind(c),removeEventListener:c.removeEventListener.bind(c)}),makeTokenAndSaveRefresh:function(t,i){let{refresh_token:a,expires_in:r,access_token:s}=t;return null!=r||(0,T.A)(!1),t5(e,{refresh_token:a,refreshTokenMarker:n}),o={refresh_token:a,expires_in:r,access_token:s,expires_at:Date.now()+1e3*r},c.dispatchTypedEvent(i,new t2(i,{detail:o})),o}}}(j,_,async function(){var e,t;return null!==(t=null!==(e=await E())&&void 0!==e?e:await A())&&void 0!==t?t:await M()},k,E.bind(globalThis,!0),v),S=async e=>{if(a){window.history.replaceState({},"",e);return}throw window.location.assign(e),await (0,t9.Ay)(1e3),Error("Unable to redirect")};async function E(e){var t,a;let{refresh_token:r,refreshTokenMarker:n}=JSON.parse(null!==(a=null===(t=globalThis.localStorage)||void 0===t?void 0:t.getItem(t3(j)))&&void 0!==a?a:"{}");if(!r||n!==v){if(e)throw Error("No refresh token found");return}try{let e=N(t1(await (0,tZ.EG)(_,j,await (0,tZ.ur)(_,j,r,k))),"refresh");if(e&&window.location.pathname===new URL(i).pathname){let{oldUrl:e}=t7(j);S(null!=e?e:"/")}return e}catch(t){if(t4(j),e)throw Error("Could not refresh token")}}async function A(){let{state:e,oldUrl:t,codeVerifier:a}=t7(j);if(a)try{let r=N(t1(await (0,tZ.EG)(_,j,await (0,tZ.m)(_,j,t1((0,tZ.kO)(_,j,new URL(window.location.href),e)),i,a,k))),"signIn");return S(t),r}catch(e){var r;throw t4(j),null===(r=globalThis.sessionStorage)||void 0===r||r.removeItem(t3(j)),e}}let M=async()=>{var e;if(r&&window.location.href!==r&&window.location.pathname!==r){t5(j,{}),t6(j,{oldUrl:n}),await S(r);return}let t=(0,tZ.Ot)(),a=(0,tZ.YI)(),s=null!==(e=t7(j).oldUrl)&&void 0!==e?e:window.location.toString();throw t5(j,{}),t6(j,{codeVerifier:a,state:t,oldUrl:s}),window.location.assign("".concat(_.authorization_endpoint,"?").concat(new URLSearchParams({client_id:"123",response_type:"code",state:t,redirect_uri:i,code_challenge:await (0,tZ.Yv)(a),code_challenge_method:"S256",scope:["offline_access",...o].join(" ")}))),await (0,t9.Ay)(1e3),Error("Unable to redirect")};return O}(0,t8,ie,!0,void 0,window.location.toString(),it)),ia)},6015:(e,t,i)=>{i.d(t,{qZ:()=>a,fn:()=>r,Tp:()=>n});var a={};i.r(a),i.d(a,{actionTakesAllParameterTypes:()=>s,assignEmployee1:()=>l,createFooInterface:()=>c,createMediaObject:()=>u,createMediaViaFunction:()=>p,createOsdkTestObject:()=>d,createStructPerson:()=>y,createStructPersonOpiTeam:()=>f,createTodo:()=>h,deleteFooInterface:()=>m,deleteOsdkTestObject:()=>b,editOsdkTestObject:()=>g});var r={};i.r(r),i.d(r,{BgaoNflPlayer:()=>v,BoundariesUsState:()=>w,BuilderDeploymentState:()=>T,Country_1:()=>j,DherlihyComplexObject:()=>_,Employee:()=>k,FintrafficAis:()=>N,GtfsTripTrackObject:()=>O,MatthewvsDevOrderEmbedding:()=>S,McAirportStruct:()=>E,MnayanOsdkMediaObject:()=>A,MtaBus:()=>M,ObjectTypeWithAllPropertyTypes:()=>P,OsdkTestObject:()=>$,Person:()=>R,RhemmingsObjectWithGtsrProperty2:()=>I,SotSensor:()=>C,StateTerritory:()=>D,StructPerson:()=>L,StructPersonOpisTeam:()=>x,Todo:()=>K,Venture:()=>W,WeatherStation:()=>U});var n={};i.r(n),i.d(n,{getNamesOfCustomersFromCountry:()=>B,getTodoCount:()=>F,queryTakesAllParameterTypes:()=>V});let o={extraUserAgent:"typescript-sdk/dev osdk-cli/dev"},s={apiName:"actionTakesAllParameterTypes",type:"action",osdkMetadata:o},l={apiName:"assignEmployee1",type:"action",osdkMetadata:o},c={apiName:"createFooInterface",type:"action",osdkMetadata:o},u={apiName:"createMediaObject",type:"action",osdkMetadata:o},p={apiName:"createMediaViaFunction",type:"action",osdkMetadata:o},d={apiName:"createOsdkTestObject",type:"action",osdkMetadata:o},y={apiName:"createStructPerson",type:"action",osdkMetadata:o},f={apiName:"createStructPersonOpiTeam",type:"action",osdkMetadata:o},h={apiName:"createTodo",type:"action",osdkMetadata:o},m={apiName:"deleteFooInterface",type:"action",osdkMetadata:o},b={apiName:"deleteOsdkTestObject",type:"action",osdkMetadata:o},g={apiName:"editOsdkTestObject",type:"action",osdkMetadata:o},v={type:"object",apiName:"BgaoNflPlayer",osdkMetadata:o},w={type:"object",apiName:"BoundariesUsState",osdkMetadata:o},T={type:"object",apiName:"BuilderDeploymentState",osdkMetadata:o},j={type:"object",apiName:"Country_1",osdkMetadata:o},_={type:"object",apiName:"DherlihyComplexObject",osdkMetadata:o},k={type:"object",apiName:"Employee",osdkMetadata:o},N={type:"object",apiName:"FintrafficAis",osdkMetadata:o},O={type:"object",apiName:"GtfsTripTrackObject",osdkMetadata:o},S={type:"object",apiName:"MatthewvsDevOrderEmbedding",osdkMetadata:o},E={type:"object",apiName:"McAirportStruct",osdkMetadata:o},A={type:"object",apiName:"MnayanOsdkMediaObject",osdkMetadata:o},M={type:"object",apiName:"MtaBus",osdkMetadata:o},P={type:"object",apiName:"ObjectTypeWithAllPropertyTypes",osdkMetadata:o},$={type:"object",apiName:"OsdkTestObject",osdkMetadata:o},R={type:"object",apiName:"Person",osdkMetadata:o},I={type:"object",apiName:"RhemmingsObjectWithGtsrProperty2",osdkMetadata:o},C={type:"object",apiName:"SotSensor",osdkMetadata:o},D={type:"object",apiName:"StateTerritory",osdkMetadata:o},L={type:"object",apiName:"StructPerson",osdkMetadata:o},x={type:"object",apiName:"StructPersonOpisTeam",osdkMetadata:o},K={type:"object",apiName:"Todo",osdkMetadata:o},W={type:"object",apiName:"Venture",osdkMetadata:o},U={type:"object",apiName:"WeatherStation",osdkMetadata:o},B={apiName:"getNamesOfCustomersFromCountry",type:"query",version:"0.1.1",osdkMetadata:o},F={apiName:"getTodoCount",type:"query",version:"0.1.2",osdkMetadata:o},V={apiName:"queryTakesAllParameterTypes",type:"query",version:"version",osdkMetadata:o}}}]);