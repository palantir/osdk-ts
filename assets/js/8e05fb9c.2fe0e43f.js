"use strict";(self.webpackChunk_osdk_docs=self.webpackChunk_osdk_docs||[]).push([[571],{8994:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var i=t(6106),o=t(8784);const s={sidebar_position:3},a="Actions",c={id:"react/actions",title:"Actions",description:"This guide covers executing actions, validation, optimistic updates, and debouncing patterns.",source:"@site/react/actions.md",sourceDirName:"react",slug:"/react/actions",permalink:"/osdk-ts/react/actions",draft:!1,unlisted:!1,editUrl:"https://github.com/palantir/osdk-ts/tree/main/docs/react/actions.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docs",previous:{title:"Querying Data",permalink:"/osdk-ts/react/querying-data"},next:{title:"Advanced Queries",permalink:"/osdk-ts/react/advanced-queries"}},l={},d=[{value:"useOsdkAction",id:"useosdkaction",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Return Values",id:"return-values",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation",id:"validation",level:2},{value:"Batch Actions",id:"batch-actions",level:2},{value:"Optimistic Updates",id:"optimistic-updates",level:2},{value:"How Optimistic Updates Work",id:"how-optimistic-updates-work",level:3},{value:"Optimistic Update API",id:"optimistic-update-api",level:3},{value:"useDebouncedCallback",id:"usedebouncedcallback",level:2},{value:"Basic Usage",id:"basic-usage-1",level:3},{value:"Auto-Save Pattern",id:"auto-save-pattern",level:3},{value:"Debounced Callback Methods",id:"debounced-callback-methods",level:3}];function r(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"actions",children:"Actions"}),"\n",(0,i.jsx)(n.p,{children:"This guide covers executing actions, validation, optimistic updates, and debouncing patterns."}),"\n",(0,i.jsx)(n.h2,{id:"useosdkaction",children:"useOsdkAction"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Experimental - import from ",(0,i.jsx)(n.code,{children:"@osdk/react/experimental"})]})}),"\n",(0,i.jsx)(n.p,{children:"Execute and validate actions with automatic state management."}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions, Todo } from "@my/osdk";\nimport { useOsdkAction, useOsdkObject } from "@osdk/react/experimental";\nimport { useCallback } from "react";\n\nfunction TodoView({ todo }: { todo: Todo.OsdkInstance }) {\n  const { isLoading } = useOsdkObject(todo);\n  const { applyAction, data, error, isPending } = useOsdkAction(\n    $Actions.completeTodo,\n  );\n\n  const onClick = useCallback(() => {\n    applyAction({\n      todo: todo,\n      isComplete: true,\n    });\n  }, [applyAction, todo]);\n\n  return (\n    <div>\n      <div>\n        {todo.title}\n        {todo.isComplete === false && (\n          <button onClick={onClick} disabled={isPending}>\n            Mark Complete\n          </button>\n        )}\n        {isPending && "(Applying)"}\n        {data && "(Action completed successfully)"}\n      </div>\n      {error && (\n        <div>\n          An error occurred:\n          <pre>{JSON.stringify(error, null, 2)}</pre>\n        </div>\n      )}\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"return-values",children:"Return Values"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"applyAction"})," - Function to execute the action (accepts single args object or array for batch)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"data"})," - Return value from the last successful action execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"error"})," - Error object (see error handling below)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"isPending"})," - True while action is executing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"isValidating"})," - True while validation is in progress"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validateAction"})," - Function to validate without executing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validationResult"})," - Result of last validation"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"error"})," object has the following structure:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"{\n  actionValidation?: ActionValidationError;\n  unknown?: unknown;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ActionValidationError"})," extends ",(0,i.jsx)(n.code,{children:"Error"})," and has:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"message"})," - Error message string"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validation"})," - Full validation response from server"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions, Todo } from "@my/osdk";\nimport { useOsdkAction } from "@osdk/react/experimental";\n\nfunction TodoActionWithErrorHandling({ todo }: { todo: Todo.OsdkInstance }) {\n  const { applyAction, error, isPending } = useOsdkAction($Actions.completeTodo);\n\n  const onClick = async () => {\n    try {\n      await applyAction({ todo, isComplete: true });\n    } catch (e) {\n      console.error("Action failed", e);\n    }\n  };\n\n  return (\n    <div>\n      <button onClick={onClick} disabled={isPending}>\n        Complete Todo\n      </button>\n\n      {error?.actionValidation && (\n        <div style={{ color: "red" }}>\n          Validation failed: {JSON.stringify(error.actionValidation.validation)}\n        </div>\n      )}\n\n      {error?.unknown && (\n        <div style={{ color: "red" }}>\n          An unexpected error occurred: {String(error.unknown)}\n        </div>\n      )}\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"validation",children:"Validation"}),"\n",(0,i.jsxs)(n.p,{children:["Validate action parameters without executing using ",(0,i.jsx)(n.code,{children:"validateAction"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions } from "@my/osdk";\nimport { useOsdkAction } from "@osdk/react/experimental";\nimport { useState } from "react";\n\nfunction TodoForm() {\n  const [title, setTitle] = useState("");\n  const [assignee, setAssignee] = useState("");\n\n  const {\n    applyAction,\n    validateAction,\n    isValidating,\n    validationResult,\n    isPending,\n    error,\n  } = useOsdkAction($Actions.createTodo);\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newTitle = e.target.value;\n    setTitle(newTitle);\n    validateAction({ title: newTitle, assignee });\n  };\n\n  const handleAssigneeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newAssignee = e.target.value;\n    setAssignee(newAssignee);\n    validateAction({ title, assignee: newAssignee });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (validationResult?.result === "VALID") {\n      await applyAction({ title, assignee });\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input\n        type="text"\n        value={title}\n        onChange={handleTitleChange}\n        placeholder="Todo title"\n      />\n      <input\n        type="text"\n        value={assignee}\n        onChange={handleAssigneeChange}\n        placeholder="Assignee"\n      />\n\n      {isValidating && <span>Validating...</span>}\n\n      {validationResult?.result === "INVALID" && (\n        <div style={{ color: "red" }}>\n          Invalid: {JSON.stringify(validationResult)}\n        </div>\n      )}\n\n      <button\n        type="submit"\n        disabled={isPending || isValidating || validationResult?.result !== "VALID"}\n      >\n        Create Todo\n      </button>\n\n      {error?.actionValidation && (\n        <div style={{ color: "red" }}>\n          Validation error: {error.actionValidation.message}\n        </div>\n      )}\n    </form>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Key features:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validateAction"})," - Validates action parameters without executing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"isValidating"})," - True while validation is in progress"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validationResult"})," - Contains ",(0,i.jsx)(n.code,{children:'{ result: "VALID" | "INVALID", ... }'})]}),"\n",(0,i.jsxs)(n.li,{children:["Calling ",(0,i.jsx)(n.code,{children:"validateAction"})," while a previous validation is in progress cancels the previous one"]}),"\n",(0,i.jsx)(n.li,{children:"Validation and execution are mutually exclusive"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"batch-actions",children:"Batch Actions"}),"\n",(0,i.jsx)(n.p,{children:"Apply the same action to multiple items in a single call:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions, Todo } from "@my/osdk";\nimport { useOsdkAction } from "@osdk/react/experimental";\nimport { useCallback } from "react";\n\nfunction BulkCompleteButton({ todos }: { todos: Todo.OsdkInstance[] }) {\n  const { applyAction, isPending } = useOsdkAction($Actions.completeTodo);\n\n  const onClick = useCallback(() => {\n    applyAction(\n      todos.map(todo => ({\n        todo: todo,\n        isComplete: true,\n      })),\n    );\n  }, [applyAction, todos]);\n\n  return (\n    <button onClick={onClick} disabled={isPending}>\n      Complete All ({todos.length})\n    </button>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"optimistic-updates",children:"Optimistic Updates"}),"\n",(0,i.jsx)(n.p,{children:"Apply changes to the cache immediately while waiting for the server response."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions, Todo } from "@my/osdk";\nimport { useOsdkAction, useOsdkObject } from "@osdk/react/experimental";\nimport { useCallback } from "react";\n\nfunction TodoView({ todo }: { todo: Todo.OsdkInstance }) {\n  const { isLoading, isOptimistic } = useOsdkObject(todo);\n  const { applyAction, error, isPending } = useOsdkAction($Actions.completeTodo);\n\n  const onClick = useCallback(() => {\n    applyAction({\n      todo: todo,\n      isComplete: true,\n\n      $optimisticUpdate: (ou) => {\n        ou.updateObject(todo.$clone({ isComplete: true }));\n      },\n    });\n  }, [applyAction, todo]);\n\n  return (\n    <div>\n      {todo.title}\n      {todo.isComplete === false && !isOptimistic && (\n        <button onClick={onClick} disabled={isPending}>Mark Complete</button>\n      )}\n      {isPending && "(Saving)"}\n      {isLoading && "(Loading)"}\n      {isOptimistic && "(Optimistic)"}\n      {error && (\n        <div style={{ color: "red" }}>\n          {error.actionValidation?.message ?? String(error.unknown)}\n        </div>\n      )}\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"how-optimistic-updates-work",children:"How Optimistic Updates Work"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["When you call ",(0,i.jsx)(n.code,{children:"applyAction"})," with ",(0,i.jsx)(n.code,{children:"$optimisticUpdate"}),", the cache is updated immediately"]}),"\n",(0,i.jsxs)(n.li,{children:["The UI shows the optimistic state (tracked via ",(0,i.jsx)(n.code,{children:"isOptimistic"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"If the action succeeds, the cache is refreshed with server data"}),"\n",(0,i.jsx)(n.li,{children:"If the action fails, the optimistic changes are rolled back automatically"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"optimistic-update-api",children:"Optimistic Update API"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$optimisticUpdate"})," callback receives an object with the following methods:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"$optimisticUpdate: (ou) => {\n  ou.updateObject(todo.$clone({ isComplete: true }));\n  ou.updateObject(anotherObject.$clone({ ... }));\n}\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["The ",(0,i.jsx)(n.code,{children:"$clone"})," method"]}),(0,i.jsxs)(n.p,{children:["Every OSDK object instance has a ",(0,i.jsx)(n.code,{children:"$clone()"})," method that creates a new object with modified properties. This is essential for optimistic updates because OSDK objects are immutable."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'// Create a modified copy without mutating the original\nconst completedTodo = todo.$clone({ isComplete: true });\n\n// Clone with multiple property changes\nconst updatedTodo = todo.$clone({\n  title: "New Title",\n  priority: "high",\n});\n'})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"usedebouncedcallback",children:"useDebouncedCallback"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Experimental - import from ",(0,i.jsx)(n.code,{children:"@osdk/react/experimental"})]})}),"\n",(0,i.jsx)(n.p,{children:"Debounce callback functions for auto-save patterns or expensive operations."}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { useDebouncedCallback } from "@osdk/react/experimental";\nimport { useState } from "react";\n\nfunction SearchableList({ onSearch }: { onSearch: (query: string) => void }) {\n  const [query, setQuery] = useState("");\n\n  const debouncedSearch = useDebouncedCallback((q: string) => {\n    onSearch(q);\n  }, 500);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setQuery(value);\n    debouncedSearch(value);\n  };\n\n  return (\n    <input\n      value={query}\n      onChange={handleChange}\n      placeholder="Search..."\n    />\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"auto-save-pattern",children:"Auto-Save Pattern"}),"\n",(0,i.jsx)(n.p,{children:"Combine with actions for auto-saving:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { $Actions, Todo } from "@my/osdk";\nimport { useDebouncedCallback, useOsdkAction } from "@osdk/react/experimental";\nimport { useState } from "react";\n\nfunction AutoSaveTodo({ todo }: { todo: Todo.OsdkInstance }) {\n  const [title, setTitle] = useState(todo.title);\n  const { applyAction } = useOsdkAction($Actions.updateTodo);\n\n  const debouncedSave = useDebouncedCallback((newTitle: string) => {\n    applyAction({\n      todo,\n      title: newTitle,\n      $optimisticUpdate: (ou) => {\n        ou.updateObject(todo.$clone({ title: newTitle }));\n      },\n    });\n  }, 1000);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newTitle = e.target.value;\n    setTitle(newTitle);\n    debouncedSave(newTitle);\n  };\n\n  return (\n    <input\n      value={title}\n      onChange={handleChange}\n      placeholder="Click to edit title..."\n    />\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"debounced-callback-methods",children:"Debounced Callback Methods"}),"\n",(0,i.jsx)(n.p,{children:"The returned function has utility methods:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { useDebouncedCallback } from "@osdk/react/experimental";\n\nconst debouncedFn = useDebouncedCallback((value: string) => {\n  console.log("Called with:", value);\n}, 500);\n\ndebouncedFn("hello");\ndebouncedFn.cancel();\ndebouncedFn.flush();\n'})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},8784:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var i=t(7378);const o={},s=i.createContext(o);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);