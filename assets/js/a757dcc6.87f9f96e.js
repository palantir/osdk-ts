"use strict";(self.webpackChunk_osdk_docs=self.webpackChunk_osdk_docs||[]).push([[99],{7682:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>d,toc:()=>c});var t=r(6106),i=r(8784);const s={sidebar_position:4},o="Advanced Queries",d={id:"react/advanced-queries",title:"Advanced Queries",description:"This guide covers advanced querying patterns including useObjectSet, derived properties, aggregations, and metadata.",source:"@site/react/advanced-queries.md",sourceDirName:"react",slug:"/react/advanced-queries",permalink:"/osdk-ts/react/advanced-queries",draft:!1,unlisted:!1,editUrl:"https://github.com/palantir/osdk-ts/tree/main/docs/react/advanced-queries.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"docs",previous:{title:"Actions",permalink:"/osdk-ts/react/actions"},next:{title:"Cache Management",permalink:"/osdk-ts/react/cache-management"}},a={},c=[{value:"useObjectSet",id:"useobjectset",level:2},{value:"When to Use useObjectSet vs useOsdkObjects",id:"when-to-use-useobjectset-vs-useosdkobjects",level:3},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Set Operations",id:"set-operations",level:3},{value:"Union",id:"union",level:4},{value:"Intersect",id:"intersect",level:4},{value:"Subtract",id:"subtract",level:4},{value:"Combined Operations",id:"combined-operations",level:4},{value:"Link Traversal with pivotTo",id:"link-traversal-with-pivotto",level:3},{value:"Auto-Fetching and Streaming",id:"auto-fetching-and-streaming",level:3},{value:"All Options",id:"all-options",level:3},{value:"Return Values",id:"return-values",level:3},{value:"Derived Properties",id:"derived-properties",level:2},{value:"Basic Usage",id:"basic-usage-1",level:3},{value:"Builder Methods",id:"builder-methods",level:3},{value:"Advanced Examples",id:"advanced-examples",level:3},{value:"Filtering on Derived Properties",id:"filtering-on-derived-properties",level:3},{value:"useOsdkFunction",id:"useosdkfunction",level:2},{value:"Basic Usage",id:"basic-usage-2",level:3},{value:"Functions Without Parameters",id:"functions-without-parameters",level:3},{value:"Dependency Tracking",id:"dependency-tracking",level:3},{value:"Specific Object Dependencies",id:"specific-object-dependencies",level:3},{value:"Conditional Execution",id:"conditional-execution",level:3},{value:"Options",id:"options",level:3},{value:"Return Values",id:"return-values-1",level:3},{value:"useOsdkAggregation",id:"useosdkaggregation",level:2},{value:"Simple Aggregation",id:"simple-aggregation",level:3},{value:"Grouped Aggregations",id:"grouped-aggregations",level:3},{value:"Filtered Aggregations",id:"filtered-aggregations",level:3},{value:"Aggregation Syntax",id:"aggregation-syntax",level:3},{value:"Options",id:"options-1",level:3},{value:"Return Values",id:"return-values-2",level:3},{value:"useOsdkMetadata",id:"useosdkmetadata",level:2},{value:"Return Values",id:"return-values-3",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"useObjectSet",id:"useobjectset-1",level:3},{value:"Derived Properties",id:"derived-properties-1",level:3},{value:"Aggregations",id:"aggregations",level:3}];function l(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"advanced-queries",children:"Advanced Queries"}),"\n",(0,t.jsx)(n.p,{children:"This guide covers advanced querying patterns including useObjectSet, derived properties, aggregations, and metadata."}),"\n",(0,t.jsx)(n.h2,{id:"useobjectset",children:"useObjectSet"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Experimental - import from ",(0,t.jsx)(n.code,{children:"@osdk/react/experimental"})]})}),"\n",(0,t.jsx)(n.p,{children:"Advanced querying with set operations, derived properties, and link traversal."}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-useobjectset-vs-useosdkobjects",children:"When to Use useObjectSet vs useOsdkObjects"}),"\n",(0,t.jsx)(n.p,{children:"Both hooks support where, orderBy, pagination, withProperties, pivotTo, autoFetchMore, and streamUpdates."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use useOsdkObjects when:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Passing an ObjectType or Interface directly (",(0,t.jsx)(n.code,{children:"Todo"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use useObjectSet when:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Starting from an ObjectSet instance (",(0,t.jsx)(n.code,{children:"$(Todo)"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Need set operations (",(0,t.jsx)(n.code,{children:"union"}),", ",(0,t.jsx)(n.code,{children:"intersect"}),", ",(0,t.jsx)(n.code,{children:"subtract"}),") with other ObjectSets"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"useOsdkObjects"})," is in active development to reach full OSDK TypeScript client parity as it has more performance enhancements. ",(0,t.jsx)(n.code,{children:"useObjectSet"})," currently supports everything and should be used if a feature you need isn't present in ",(0,t.jsx)(n.code,{children:"useOsdkObjects"}),". Check the JSDoc for current feature support."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet, useOsdkObjects } from "@osdk/react/experimental";\n\n// Simple query - use useOsdkObjects\nconst { data } = useOsdkObjects(Todo, {\n  where: { isComplete: false },\n  orderBy: { createdAt: "desc" },\n});\n\n// Set operations - use useObjectSet\nconst urgentTodos = $(Todo).where({ isUrgent: true });\nconst completedTodos = $(Todo).where({ isComplete: true });\n\nconst { data } = useObjectSet($(Todo), {\n  union: [urgentTodos],\n  subtract: [completedTodos],\n});\n'})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.mdxAdmonitionTitle,{children:["The ",(0,t.jsx)(n.code,{children:"$"})," function"]}),(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"$"})," function from your generated SDK creates an ObjectSet from an object type. ",(0,t.jsx)(n.code,{children:"$(Todo)"})," creates an ObjectSet containing all Todo objects that you can then filter, union, intersect, or subtract with other ObjectSets."]})]}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction TodosWithSetOperations() {\n  const allTodos = $(Todo);\n  const completedTodos = $(Todo).where({ isComplete: true });\n\n  const { data, isLoading, fetchMore } = useObjectSet(allTodos, {\n    subtract: [completedTodos],\n    where: { priority: "high" },\n    orderBy: { createdAt: "desc" },\n    pageSize: 20,\n  });\n\n  return (\n    <div>\n      {data?.map(todo => (\n        <div key={todo.$primaryKey}>\n          {todo.title}\n        </div>\n      ))}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"set-operations",children:"Set Operations"}),"\n",(0,t.jsx)(n.h4,{id:"union",children:"Union"}),"\n",(0,t.jsx)(n.p,{children:"Combine multiple object sets:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction CombinedTodoQuery() {\n  const highPriorityTodos = $(Todo).where({ priority: "high" });\n  const urgentTodos = $(Todo).where({ isUrgent: true });\n\n  const { data } = useObjectSet(highPriorityTodos, {\n    union: [urgentTodos], // High priority OR urgent\n  });\n\n  return <div>High priority or urgent: {data?.length}</div>;\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"intersect",children:"Intersect"}),"\n",(0,t.jsx)(n.p,{children:"Find objects that exist in all sets:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Employee } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction SharedProjects({ employee1, employee2 }: {\n  employee1: Employee.OsdkInstance;\n  employee2: Employee.OsdkInstance;\n}) {\n  const set1 = $(Employee).where({ id: employee1.id });\n  const set2 = $(Employee).where({ id: employee2.id });\n\n  const { data } = useObjectSet(set1, {\n    pivotTo: "projects",\n    intersect: [set2.$pivotTo("projects")],\n  });\n\n  return (\n    <div>\n      <h3>Shared Projects</h3>\n      {data?.map(project => (\n        <div key={project.$primaryKey}>{project.name}</div>\n      ))}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"subtract",children:"Subtract"}),"\n",(0,t.jsx)(n.p,{children:"Remove objects that exist in another set:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction ActiveTodos() {\n  const allTodos = $(Todo);\n  const completedTodos = $(Todo).where({ isComplete: true });\n\n  const { data } = useObjectSet(allTodos, {\n    subtract: [completedTodos],\n  });\n\n  return <div>Active todos: {data?.length}</div>;\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"combined-operations",children:"Combined Operations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction ComplexTodoQuery() {\n  const highPriorityTodos = $(Todo).where({ priority: "high" });\n  const urgentTodos = $(Todo).where({ isUrgent: true });\n  const completedTodos = $(Todo).where({ isComplete: true });\n\n  const { data } = useObjectSet(highPriorityTodos, {\n    union: [urgentTodos],        // High priority OR urgent\n    subtract: [completedTodos],  // But not completed\n  });\n\n  return <div>High priority or urgent (but not completed): {data?.length}</div>;\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"link-traversal-with-pivotto",children:"Link Traversal with pivotTo"}),"\n",(0,t.jsx)(n.p,{children:"Navigate to linked objects:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Employee } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nfunction EmployeeDepartments({ employee }: { employee: Employee.OsdkInstance }) {\n  const employeeSet = $(Employee).where({ id: employee.id });\n\n  const { data } = useObjectSet(employeeSet, {\n    pivotTo: "department",\n  });\n\n  return (\n    <div>\n      Departments: {data?.map(dept => dept.name).join(", ")}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"auto-fetching-and-streaming",children:"Auto-Fetching and Streaming"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { $, Todo } from "@my/osdk";\nimport { useObjectSet } from "@osdk/react/experimental";\n\nconst { data, isLoading } = useObjectSet($(Todo), {\n  where: { isComplete: false },\n  autoFetchMore: 200,     // Fetch at least 200 items\n  streamUpdates: true,    // Real-time WebSocket updates\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"all-options",children:"All Options"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"where"})," - Filter objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"withProperties"})," - Add derived/computed properties"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"union"})," - Combine with other ObjectSets"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"intersect"})," - Find common objects with other ObjectSets"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"subtract"})," - Remove objects that exist in other ObjectSets"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"pivotTo"})," - Traverse to linked objects (changes result type)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"pageSize"})," - Number of objects per page"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"orderBy"})," - Sort order"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dedupeIntervalMs"})," - Minimum time between re-fetches (default: 2000ms)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"streamUpdates"})," - Enable real-time websocket updates (default: false)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"autoFetchMore"})," - Auto-fetch additional pages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enabled"})," - Enable/disable the query"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"return-values",children:"Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"data"})," - Array of objects with derived properties"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"isLoading"})," - True while fetching"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"error"})," - Error object if fetch failed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"fetchMore"})," - Function to load next page"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"objectSet"})," - The transformed ObjectSet after all operations"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"derived-properties",children:"Derived Properties"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Available in both useOsdkObjects and useObjectSet"})}),"\n",(0,t.jsx)(n.p,{children:"Add computed properties calculated server-side using the builder pattern."}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,t.jsxs)(n.p,{children:["Derived properties use a builder function that receives a ",(0,t.jsx)(n.code,{children:"DerivedProperty.Builder"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import type { DerivedProperty } from "@osdk/client";\nimport { Employee } from "@my/osdk";\nimport { useOsdkObjects } from "@osdk/react/experimental";\n\nconst { data } = useOsdkObjects(Employee, {\n  where: { department: "Engineering" },\n  withProperties: {\n    // Get manager\'s name via link traversal\n    managerName: (base: DerivedProperty.Builder<Employee, false>) =>\n      base.pivotTo("manager").selectProperty("fullName"),\n\n    // Count direct reports\n    reportCount: (base: DerivedProperty.Builder<Employee, false>) =>\n      base.pivotTo("reports").aggregate("$count"),\n  },\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"builder-methods",children:"Builder Methods"}),"\n",(0,t.jsx)(n.p,{children:"The builder provides these methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:".pivotTo(linkName)"})," - Navigate to linked objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:".selectProperty(propertyName)"})," - Select a property value"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:".aggregate(aggregation)"})," - Aggregate values (",(0,t.jsx)(n.code,{children:'"$count"'}),", ",(0,t.jsx)(n.code,{children:'"propertyName:$avg"'}),", etc.)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:".where(clause)"})," - Filter before aggregating"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"advanced-examples",children:"Advanced Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import type { DerivedProperty } from "@osdk/client";\n\nconst { data } = useOsdkObjects(Employee, {\n  where: { department: "Engineering" },\n  withProperties: {\n    // Chained traversal\n    departmentSize: (base: DerivedProperty.Builder<Employee, false>) =>\n      base.pivotTo("manager")\n        .pivotTo("reports")\n        .aggregate("$count"),\n\n    // Aggregate a specific property\n    avgReportSalary: (base: DerivedProperty.Builder<Employee, false>) =>\n      base.pivotTo("reports")\n        .selectProperty("salary")\n        .aggregate("$avg"),\n  },\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"filtering-on-derived-properties",children:"Filtering on Derived Properties"}),"\n",(0,t.jsx)(n.p,{children:"You can filter on derived properties in your where clause:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import type { DerivedProperty } from "@osdk/client";\n\nconst { data } = useOsdkObjects(Employee, {\n  withProperties: {\n    reportCount: (base: DerivedProperty.Builder<Employee, false>) =>\n      base.pivotTo("reports").aggregate("$count"),\n  },\n  where: {\n    department: "Engineering",\n    reportCount: { $gt: 0 }, // Only managers\n  },\n});\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"useosdkfunction",children:"useOsdkFunction"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Experimental - import from ",(0,t.jsx)(n.code,{children:"@osdk/react/experimental"})]})}),"\n",(0,t.jsx)(n.p,{children:"Execute and observe functions with request deduplication and configurable dependency tracking for automatic refetching."}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage-2",children:"Basic Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { addOne } from "@my/osdk";\nimport { useOsdkFunction } from "@osdk/react/experimental";\n\nfunction AddOneDemo() {\n  const { data, isLoading, error } = useOsdkFunction(addOne, {\n    params: { n: 5 },\n  });\n\n  if (isLoading && data === undefined) {\n    return <div>Calculating...</div>;\n  }\n\n  if (error) {\n    return <div>Error: {error.message}</div>;\n  }\n\n  return <div>Result: {data}</div>;\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"functions-without-parameters",children:"Functions Without Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { getTodoCount } from "@my/osdk";\nimport { useOsdkFunction } from "@osdk/react/experimental";\n\nfunction TodoCount() {\n  const { data, isLoading } = useOsdkFunction(getTodoCount);\n\n  return (\n    <div>\n      {isLoading && <span>Loading...</span>}\n      {data !== undefined && <span>Total todos: {data}</span>}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dependency-tracking",children:"Dependency Tracking"}),"\n",(0,t.jsx)(n.p,{children:"Automatically refetch when actions modify objects of specified types:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Employee, getEmployeeMetrics } from "@my/osdk";\nimport { useOsdkFunction } from "@osdk/react/experimental";\n\nfunction EmployeeMetrics({ departmentId }: { departmentId: string }) {\n  const { data, isLoading, refetch } = useOsdkFunction(getEmployeeMetrics, {\n    params: { departmentId },\n    dependsOn: [Employee], // Refetch when any Employee changes\n  });\n\n  return (\n    <div>\n      {isLoading && <span>Updating...</span>}\n      {data && <span>Headcount: {data.headcount}</span>}\n      <button onClick={refetch}>Refresh</button>\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"specific-object-dependencies",children:"Specific Object Dependencies"}),"\n",(0,t.jsx)(n.p,{children:"For finer-grained control, depend on specific object instances:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Employee, getEmployeeReport } from "@my/osdk";\nimport { useOsdkFunction, useOsdkObject } from "@osdk/react/experimental";\n\nfunction EmployeeReport({ employee }: { employee: Employee.OsdkInstance }) {\n  const { data, isLoading } = useOsdkFunction(getEmployeeReport, {\n    params: { employeeId: employee.$primaryKey },\n    dependsOnObjects: [employee], // Refetch only when this employee changes\n  });\n\n  return (\n    <div>\n      {isLoading && <span>Loading report...</span>}\n      {data && <pre>{JSON.stringify(data, null, 2)}</pre>}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"conditional-execution",children:"Conditional Execution"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"enabled"})," to control when the function executes:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Employee, getEmployeeReport } from "@my/osdk";\nimport { useOsdkFunction, useOsdkObject } from "@osdk/react/experimental";\n\nfunction ConditionalReport({ employeeId }: { employeeId: string }) {\n  const { object: employee } = useOsdkObject(Employee, employeeId);\n\n  const { data, isLoading } = useOsdkFunction(getEmployeeReport, {\n    params: { employeeId },\n    enabled: employee !== undefined, // Wait for employee to load\n  });\n\n  if (!employee) {\n    return <div>Loading employee...</div>;\n  }\n\n  return (\n    <div>\n      <h2>{employee.fullName}</h2>\n      {isLoading && <span>Loading report...</span>}\n      {data && <div>Report: {JSON.stringify(data)}</div>}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"params"})," - Parameters to pass to the function (required if function has parameters)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dependsOn"})," - Array of object types; refetch when any object of these types changes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dependsOnObjects"})," - Array of specific object instances; refetch when these objects change"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dedupeIntervalMs"})," - Milliseconds to dedupe identical calls (default: 2000)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enabled"})," - Enable/disable execution (default: true)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"return-values-1",children:"Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"data"})," - Function result, or undefined if not loaded or on error"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"isLoading"})," - True while the function is executing"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"error"})," - Error object if execution failed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lastUpdated"})," - Timestamp (ms since epoch) when result was last fetched"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"refetch"})," - Function to manually trigger a refetch"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"useosdkaggregation",children:"useOsdkAggregation"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Experimental - import from ",(0,t.jsx)(n.code,{children:"@osdk/react/experimental"})]})}),"\n",(0,t.jsx)(n.p,{children:"Server-side grouping and aggregation."}),"\n",(0,t.jsx)(n.h3,{id:"simple-aggregation",children:"Simple Aggregation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Todo } from "@my/osdk";\nimport { useOsdkAggregation } from "@osdk/react/experimental";\n\nfunction TodoStats() {\n  const { data, isLoading, error } = useOsdkAggregation(Todo, {\n    aggregate: {\n      $select: {\n        $count: "unordered",\n        "priority:avg": "unordered",\n        "dueDate:max": "unordered",\n      },\n    },\n  });\n\n  if (isLoading) {\n    return <div>Calculating stats...</div>;\n  }\n\n  if (error) {\n    return <div>Error: {JSON.stringify(error)}</div>;\n  }\n\n  // Results: "propertyName:metric" in $select becomes data.propertyName.metric\n  return (\n    <div>\n      <p>Total Todos: {data?.$count}</p>\n      <p>Average Priority: {data?.priority.avg}</p>\n      <p>Latest Due Date: {data?.dueDate.max}</p>\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"grouped-aggregations",children:"Grouped Aggregations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Todo } from "@my/osdk";\nimport { useOsdkAggregation } from "@osdk/react/experimental";\n\nfunction TodosByStatus() {\n  const { data, isLoading } = useOsdkAggregation(Todo, {\n    aggregate: {\n      $groupBy: { status: "exact" },\n      $select: {\n        $count: "unordered",\n        "priority:avg": "unordered",\n      },\n    },\n  });\n\n  if (isLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div>\n      {data?.map((group, idx) => (\n        <div key={idx}>\n          <h3>Status: {group.$group.status}</h3>\n          <p>Count: {group.$count}</p>\n          <p>Avg Priority: {group.priority.avg}</p>\n        </div>\n      ))}\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"filtered-aggregations",children:"Filtered Aggregations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Todo } from "@my/osdk";\nimport { useOsdkAggregation } from "@osdk/react/experimental";\n\nfunction HighPriorityStats() {\n  const { data, isLoading } = useOsdkAggregation(Todo, {\n    where: { priority: "high", isComplete: false },\n    aggregate: {\n      $select: {\n        $count: "unordered",\n        "dueDate:min": "unordered",\n      },\n    },\n  });\n\n  if (isLoading || !data) return <div>Loading...</div>;\n\n  return (\n    <div>\n      <p>High Priority Incomplete: {data.$count}</p>\n      <p>Earliest Due: {data.dueDate.min}</p>\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"aggregation-syntax",children:"Aggregation Syntax"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"$select"})," object uses a special key format where each key is a metric and each value is an ordering directive (",(0,t.jsx)(n.code,{children:'"unordered"'}),", ",(0,t.jsx)(n.code,{children:'"asc"'}),", or ",(0,t.jsx)(n.code,{children:'"desc"'}),"). When using ",(0,t.jsx)(n.code,{children:"$groupBy"}),", the ordering determines the order results are returned."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key formats:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$count"})," - Count of objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:sum"'})," - Sum of a numeric property"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:avg"'})," - Average of a numeric property"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:min"'})," - Minimum value of a property"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:max"'})," - Maximum value of a property"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:exactDistinct"'})," - Exact distinct count"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"propertyName:approximateDistinct"'})," - Approximate distinct count (more performant for large datasets)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"options-1",children:"Options"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"where"})," - Filter objects before aggregation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"withProperties"})," - Add derived properties for computed values"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"aggregate"})," - Aggregation configuration:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$select"})," (required) - Object mapping metric keys (e.g., ",(0,t.jsx)(n.code,{children:"$count"}),", ",(0,t.jsx)(n.code,{children:'"salary:avg"'}),") to ordering (",(0,t.jsx)(n.code,{children:'"unordered"'}),", ",(0,t.jsx)(n.code,{children:'"asc"'}),", or ",(0,t.jsx)(n.code,{children:'"desc"'}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$groupBy"})," (optional) - Object mapping property names to grouping strategy (e.g., ",(0,t.jsx)(n.code,{children:'"exact"'}),", ",(0,t.jsx)(n.code,{children:"{ $fixedWidth: 10 }"}),")"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dedupeIntervalMs"})," - Minimum time between re-fetches (default: 2000ms)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"return-values-2",children:"Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"data"})," - Aggregation result (single object for non-grouped, array for grouped). For ",(0,t.jsx)(n.code,{children:"$count"}),", access via ",(0,t.jsx)(n.code,{children:"data.$count"}),". For property metrics like ",(0,t.jsx)(n.code,{children:'"salary:avg"'}),", access via ",(0,t.jsx)(n.code,{children:"data.salary.avg"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"isLoading"})," - True while fetching"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"error"})," - Error object if fetch failed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"refetch"})," - Manual refetch function"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"useosdkmetadata",children:"useOsdkMetadata"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Stable - import from ",(0,t.jsx)(n.code,{children:"@osdk/react"})]})}),"\n",(0,t.jsx)(n.p,{children:"Fetch metadata about object types or interfaces."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Todo } from "@my/osdk";\nimport { useOsdkMetadata } from "@osdk/react";\n\nfunction TodoMetadataViewer() {\n  const { metadata, loading, error } = useOsdkMetadata(Todo);\n\n  if (loading) {\n    return <div>Loading metadata...</div>;\n  }\n\n  if (error) {\n    return <div>Error: {error}</div>;\n  }\n\n  return (\n    <div>\n      <h2>{metadata?.displayName}</h2>\n      <p>Description: {metadata?.description}</p>\n      <h3>Properties:</h3>\n      <ul>\n        {Object.entries(metadata?.properties || {}).map(([key, prop]) => (\n          <li key={key}>\n            {key}: {prop.dataType.type}\n            {prop.displayName && ` (${prop.displayName})`}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"return-values-3",children:"Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"metadata"})," - ObjectMetadata or InterfaceMetadata with type information"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"loading"})," - True while fetching metadata"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"error"})," - Error message string if fetch failed"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"useobjectset-1",children:"useObjectSet"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Set operations (union, intersect, subtract) are performed on the server"}),"\n",(0,t.jsx)(n.li,{children:"Each unique combination of options creates a separate cache entry"}),"\n",(0,t.jsxs)(n.li,{children:["Using ",(0,t.jsx)(n.code,{children:"pivotTo"})," creates a new query for the linked type"]}),"\n",(0,t.jsxs)(n.li,{children:["Consider using ",(0,t.jsx)(n.code,{children:"pageSize"})," to limit initial data load"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"derived-properties-1",children:"Derived Properties"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Computed server-side, so no client-side overhead"}),"\n",(0,t.jsx)(n.li,{children:"Complex derived properties with many link traversals may be slower"}),"\n",(0,t.jsx)(n.li,{children:"Filtering on derived properties happens server-side"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"aggregations",children:"Aggregations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Aggregations are always computed server-side"}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"where"})," to reduce the dataset before aggregation"]}),"\n",(0,t.jsx)(n.li,{children:"Group by produces array results that may be large"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8784:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var t=r(7378);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);